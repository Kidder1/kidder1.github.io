<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    

    
<script>!function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("use-color-scheme")||"auto";("dark"===t||e&&"light"!==t)&&document.documentElement.classList.toggle("dark",!0)}()</script>
    

<meta charset="utf-8" >

<title>Crypto_CTF</title>
<meta name="keywords" content="Crypto_CTF, Kidder1&#39;s Blog!">
<meta name="description" content="HNCTFbaBAbaseSEse（base家族）base家族 

随波逐流梭哈


basecrack一把梭，windows我装不上，然后我就装到ubuntu了


babyRsa（基本RSA）基础知识

注意：这里不能安装其他库，不然会">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="Crypto_CTF">
<meta property="og:description" content="HNCTFbaBAbaseSEse（base家族）base家族 

随波逐流梭哈


basecrack一把梭，windows我装不上，然后我就装到ubuntu了


babyRsa（基本RSA）基础知识

注意：这里不能安装其他库，不然会">

<link rel="shortcut icon" href="/favicon.ico">
<link rel="stylesheet" href="/style/main.css">

  <link rel="stylesheet" href="/style/simple-lightbox.min.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Kidder1's Blog!" type="application/atom+xml">
</head>
  <body>
    <div id="app" class="main">

<div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://kidder1.github.io">
        <img class="avatar" src="/images/avatar.png" alt="logo" width="32px" height="32px">
      </a>
      <a href="https://kidder1.github.io">
        <h1 class="site-title">Kidder1&#39;s Blog!</h1>
      </a>
    </div>
    <div class="right">
        <i class="icon menu-switch icon-menu-outline" ></i>
    </div>
  </div>
</div>

<div class="menu-container" style="height: 0;opacity: 0;">
<nav class="menu-list">
  
    
      <a href="/" class="menu purple-link">
        首页
      </a>
    
  
    
      <a href="/categories" class="menu purple-link">
        分类
      </a>
    
  
    
      <a href="/tags/" class="menu purple-link">
        标签
      </a>
    
  
    
      <a href="/archives" class="menu purple-link">
        归档
      </a>
    
  
    
      <a href="/about" class="menu purple-link">
        关于
      </a>
    
  
</nav>
</div>



  <div class="content-container">
    <div class="post-detail">
      
      <h2 class="post-title">Crypto_CTF</h2>
      <div class="post-info post-detail-info">
        <span><i class="icon icon-calendar-outline"></i> 2023-07-20</span>
        
          <span>
          <i class="icon icon-pricetags-outline"></i>
            
              <a href="/tags/crypto/">
              crypto
                
              </a>
            
          </span>
        
      </div>
      <div class="post-content-wrapper">
        <div class="post-content">
          <h1 id="HNCTF"><a href="#HNCTF" class="headerlink" title="HNCTF"></a>HNCTF</h1><h2 id="baBAbaseSEse（base家族）"><a href="#baBAbaseSEse（base家族）" class="headerlink" title="baBAbaseSEse（base家族）"></a>baBAbaseSEse（base家族）</h2><p>base家族 </p>
<ul>
<li><p>随波逐流梭哈</p>
<a class="simple-lightbox" href="/2023/07/20/crypto/image-20230720220320082.png"><img   src="/images/loading.svg" data-src="/2023/07/20/crypto/image-20230720220320082.png"  class="" lazyload></a>
</li>
<li><p>basecrack一把梭，windows我装不上，然后我就装到ubuntu了</p>
<a class="simple-lightbox" href="/2023/07/20/crypto/image-20230720224021152.png"><img   src="/images/loading.svg" data-src="/2023/07/20/crypto/image-20230720224021152.png"  class="" lazyload></a></li>
</ul>
<h2 id="babyRsa（基本RSA）"><a href="#babyRsa（基本RSA）" class="headerlink" title="babyRsa（基本RSA）"></a>babyRsa（基本RSA）</h2><p>基础知识</p>
<blockquote>
<p>注意：这里不能安装其他库，不然会因为版本问产生一系列的兼容性问题</p>
</blockquote>
<ol>
<li>PyCryptodome库主要由以下模块组成：</li>
</ol>
<ul>
<li><code>Crypto.Cipher</code>：包含对称加密算法，如AES、DES等。</li>
<li><code>Crypto.PublicKey</code>：包含非对称加密算法，如RSA、DSA等。</li>
<li><code>Crypto.Hash</code>：包含哈希函数，如SHA256、MD5等。</li>
<li><code>Crypto.Signature</code>：包含数字签名相关功能。</li>
<li><code>Crypto.Random</code>：提供随机数生成器。</li>
<li><code>Crypto.Protocol</code>：包含各种协议实现，如PBKDF2。</li>
<li><code>Crypto.Util</code>：包含一些实用工具，如填充、字节处理等</li>
</ul>
<ol start="2">
<li><p>对于RSA的一些工具</p>
<ul>
<li><p><strong>YAFU</strong>： YAFU（Yet Another Factoring Utility）是一个开源的用于整数因数分解的命令行工具。它是一个强大而灵活的工具，能够分解大整数为其质因数，有助于解决数论和密码学领域中的问题。YAFU是基于GMP（GNU多精度算法库）的，并使用了多种因数分解算法来优化分解过程。它是数学爱好者、密码学研究人员和密码分析者常用的工具之一</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.使用 cmd 进入到 yafu 所在目录下，或将目录加入到系统环境 PATH 变量，或打开目录文件夹后 shift+右键 选择在此处打开 powershell </span><br><span class="line">2.假如要分解因数 6 ，输入命令：.\yafu-x64.exe &quot;factor(6)&quot;</span><br><span class="line">3.如果因数过长，将 因数 用文本文件存放在 yafu 目录下，例如：data.txt 。文件最后一行一定要换行，否则eof; done processing batchfile。 运行命令：.\yafu-x64.exe &quot;factor(@)&quot; -batchfile data.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>FactorDB</strong>： FactorDB是一个在线的整数因数分解数据库。它允许用户将大整数提交到数据库，并查找其质因数分解。这个数据库是由全球用户提交的整数分解结果共同维护的，它采用了多种现代算法来分解整数。FactorDB 对于那些没有自己的因数分解工具或想要验证分解结果的用户来说是非常有用的。通过FactorDB，用户可以快速地找到一个整数的质因数，而无需自行进行因数分解运算 网站<a target="_blank" rel="noopener" href="http://www.factordb.com/">factordb.com</a></p>
</li>
</ul>
<p>这个题是一个简单的RSA</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="comment"># 这里我们导入了bytes_to_long函数，它用于将字节转换为长整数（将flag转换为m），以及导入了getPrime函数，它用于生成指定位数的随机素数。</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">P39 = <span class="number">265147241000574873803071047177766359643</span></span><br><span class="line">P39 = <span class="number">234560843346150602519484260867514743467</span></span><br><span class="line">q = getPrime(<span class="number">128</span>)</span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line"><span class="comment"># 这两行代码使用getPrime(128)函数生成两个128位的随机素数，并将它们赋值给变量p和q。在RSA加密中，p 和 q 是用于计算 RSA 公钥和私钥的重要参数。</span></span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">17331436837911040930486942133359735652484926528331507431552667656734821231501</span></span><br><span class="line"><span class="comment"># n 是RSA的模数，它是两个素数 p 和 q 的乘积。</span></span><br><span class="line"><span class="comment"># e 是RSA的公钥指数，通常为固定值 65537（也称为常用的 RSA 公钥指数）。</span></span><br><span class="line"><span class="comment"># c 是RSA的密文，通过用公钥指数 e 对明文 m 进行模幂运算得到。</span></span><br><span class="line"><span class="built_in">print</span>(n,c)</span><br><span class="line"><span class="comment"># 62193160459999883112594854240161159254035770172137079047232757011759606702281</span></span><br><span class="line"><span class="comment"># 17331436837911040930486942133359735652484926528331507431552667656734821231501</span></span><br></pre></td></tr></table></figure>

<p>通过上述工具进行分解之后，然后写出对应的解密脚本即可，这里主要是了解了这些库的一些基本使用而已</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">计算 RSA 私钥参数：</span><br><span class="line">使用已知的 p 和 q 计算了模数 n，并通过调用 invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)) 函数计算得到私钥指数 d。</span><br><span class="line">RSA 解密并输出明文：</span><br><span class="line">使用得到的私钥指数 d 和模数 n，将密文 c 进行 RSA 解密，并通过 long_to_bytes 函数将解密后的长整数转换为明文，并进行输出。</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">234560843346150602519484260867514743467</span></span><br><span class="line">q = <span class="number">265147241000574873803071047177766359643</span></span><br><span class="line">c = <span class="number">17331436837911040930486942133359735652484926528331507431552667656734821231501</span></span><br><span class="line">n = p * q</span><br><span class="line">d = invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>

<p>然后安装了sage的软件，还没有使用，明天再看看吧！</p>
</li>
</ol>
<h2 id="A-dictator（凯撒密码）"><a href="#A-dictator（凯撒密码）" class="headerlink" title="A dictator（凯撒密码）"></a>A dictator（凯撒密码）</h2><p>凯撒密码就是根据偏移移位的密码</p>
<p>加密过程</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># # 用于生成一个在范围 [1, 100] 内的随机整数，并将其对 26 取模，以确保得到的偏移量在 0 到 25 之间</span></span><br><span class="line">offset = randint(<span class="number">1</span>,<span class="number">100</span>) % <span class="number">26</span></span><br><span class="line"><span class="built_in">print</span>(offset)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">&#x27;NSSCTF&#123;&#x27;</span>)</span><br><span class="line"><span class="comment"># 确保flag字符串中除去前7个字符和最后一个字符的部分，所有字符都不是大写字母</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>([<span class="built_in">ord</span>(c) <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>)) <span class="keyword">for</span> c <span class="keyword">in</span> flag[<span class="number">7</span>:-<span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> flag[<span class="number">7</span>:-<span class="number">1</span>]:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= <span class="built_in">ord</span>(char) &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">        <span class="comment"># 小写字母计算偏移量</span></span><br><span class="line">        index = <span class="built_in">ord</span>(char)-<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        <span class="comment"># 计算新的字符</span></span><br><span class="line">        new_char = <span class="built_in">chr</span>((index+offset)%<span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">        <span class="built_in">print</span>(new_char,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(char,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># 密文</span></span><br><span class="line"><span class="comment"># cipher = &#x27;nby_wuymul_wcjbyl_cm_ihy_iz_nby_gimn_vumcw_wfummcwuf_wcjbylm&#x27;</span></span><br></pre></td></tr></table></figure>

<p>解密过程：这个加密解密完都是小写字母，通过25个随机数字进行爆破解密即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cipher = <span class="string">&#x27;nby_wuymul_wcjbyl_cm_ihy_iz_nby_gimn_vumcw_wfummcwuf_wcjbylm&#x27;</span></span><br><span class="line"><span class="comment"># 从0-25遍历</span></span><br><span class="line"><span class="keyword">for</span> offset <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> cipher:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= <span class="built_in">ord</span>(i) &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">            index = <span class="built_in">ord</span>(i) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">            new_char = <span class="built_in">chr</span>((index + offset) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">            <span class="built_in">print</span>(new_char, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(i, end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>官方wp有一个string的库，这里学习了一下</p>
<blockquote>
<p><strong>问：from string import ascii_lowercase  string库是什么库？</strong></p>
<p><strong>答：在Python中，<code>string</code> 是一个标准库，它包含了许多与字符串处理相关的常用常量和函数。通过导入 <code>string</code> 库，你可以使用其中定义的常量和函数，而不需要自己定义相同的内容。</strong></p>
<p><strong>在给定的代码中，使用 <code>from string import ascii_lowercase</code> 导入了 <code>string</code> 标准库中的 <code>ascii_lowercase</code> 常量。<code>ascii_lowercase</code> 是一个包含所有小写字母的字符串，它的值为 <code>&#39;abcdefghijklmnopqrstuvwxyz&#39;</code>。这样一来，代码就可以直接使用 <code>ascii_lowercase</code> 变量来表示小写字母表，而不需要手动定义这个字符串。</strong></p>
</blockquote>
<h2 id="爱妃（仿射密码）"><a href="#爱妃（仿射密码）" class="headerlink" title="爱妃（仿射密码）"></a>爱妃（仿射密码）</h2><p>放射密码（Affine Cipher）是一种古典密码学中的替换密码，它对字母表中的字符进行加密和解密。放射密码的数学原理涉及到仿射函数的应用。</p>
<p>放射函数的一般形式为：E(x) &#x3D; (ax + b) mod m</p>
<p>其中：</p>
<ul>
<li>E(x) 表示密文字符；</li>
<li>x 表示明文字符；</li>
<li>a 和 b 是整数，并且满足 a 和 m 互质（最大公约数为1）；</li>
<li>mod m 表示对 m 取模，即结果在 0 到 (m-1) 的范围内。</li>
</ul>
<p>在放射密码中，每个明文字符 x 被映射为一个密文字符 E(x)。参数 a 和 b 是放射函数的密钥，通过正确选择这些密钥，可以实现有效的加密和解密。</p>
<p>解密过程是对密文字符应用逆放射函数：D(y) &#x3D; a^(-1) * (y - b) mod m，其中 a^(-1) 表示 a 的乘法逆元素。</p>
<a class="simple-lightbox" href="/2023/07/20/crypto/image-20230722180423532.png"><img   src="/images/loading.svg" data-src="/2023/07/20/crypto/image-20230722180423532.png"  class="" lazyload></a>

<a class="simple-lightbox" href="/2023/07/20/crypto/image-20230722181454094.png"><img   src="/images/loading.svg" data-src="/2023/07/20/crypto/image-20230722181454094.png"  class="" lazyload></a>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cipher, a_invert, b, m</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([a_invert*(i   - b) % m <span class="keyword">for</span> i <span class="keyword">in</span> cipher])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message, a, b, m</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([(<span class="built_in">ord</span>(i) * a + b) % m <span class="keyword">for</span> i <span class="keyword">in</span> message])</span><br><span class="line"></span><br><span class="line">c = <span class="string">b&#x27;y\xba\xba\xea\xc7\x11\xc2\xc7\xcb\xd8ZV\xd8ZVp\xb1\xb1\xd8\x19\xa4V\xa4\x19\x8aM\xa83g\xd8&amp;\x19\xdc&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;NSSCTF&#123;&#x27;</span></span><br><span class="line"><span class="comment"># 计算密钥a，b</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">if</span> encrypt(flag, a, b, m) <span class="keyword">in</span> c:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"> 			<span class="comment"># print(a, b)</span></span><br><span class="line">m = <span class="number">1</span> &lt;&lt; <span class="number">8</span></span><br><span class="line">a = <span class="number">13</span> </span><br><span class="line">b = <span class="number">131</span></span><br><span class="line"><span class="comment"># 计算a的逆元函数</span></span><br><span class="line">a_invert = gmpy2.invert(<span class="number">13</span>,<span class="number">256</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;a_invert = &#x27;</span>, a_invert)</span><br><span class="line">m = decrypt(c,a_invert,b,m)</span><br><span class="line"><span class="built_in">print</span>(m.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="littleprince-同余方程，中国剩余定理"><a href="#littleprince-同余方程，中国剩余定理" class="headerlink" title="littleprince(同余方程，中国剩余定理)"></a>littleprince(同余方程，中国剩余定理)</h2><p>这道题的给的加密代码有一些难理解，在这里记录一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">a, b, c</span>):</span><br><span class="line">  	<span class="comment"># 1 &lt;&lt; b 表示将数字 1 左移 b 位，即得到一个只有第 b 位为1，其余位都为0的整数</span></span><br><span class="line">    <span class="comment"># 例如，如果 b 等于 3，那么 1 &lt;&lt; b 就等于二进制数 0b1000，也就是十进制数 8	</span></span><br><span class="line">	<span class="comment"># 对结果 1 &lt;&lt; b 减去 1，这样得到的二进制数将会是从第 0 位到第 b-1 位都是1，其余位都是0</span></span><br><span class="line">	<span class="comment"># 以 b 等于 3 为例，((1 &lt;&lt; 3) - 1) 将得到二进制数 0b111，也就是十进制数 7</span></span><br><span class="line">	<span class="comment"># 最后，我们将 a 和上述得到的结果进行按位与操作 &amp;，这样就会保留 a 的低 b 位，将其余高位都置为0</span></span><br><span class="line">    <span class="comment"># a的低b位的掩码在这里保留a的最后b位置，其他位置设为0</span></span><br><span class="line">    <span class="comment"># 它将这两个结果进行位或操作 | 并将低 c - b 位左移</span></span><br><span class="line">    <span class="comment"># 目的是对a进行加密并且返回</span></span><br><span class="line">    <span class="keyword">return</span> a &gt;&gt; b | (a &amp; ((<span class="number">1</span> &lt;&lt; b)-<span class="number">1</span>)) &lt;&lt; (c-b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">outp</span>(<span class="params">x, h</span>):</span><br><span class="line">    p = randint(<span class="number">1</span> &lt;&lt; h, <span class="number">1</span> &lt;&lt; h+<span class="number">1</span>)</span><br><span class="line">    q = randint(<span class="number">1</span> &lt;&lt; h, <span class="number">1</span> &lt;&lt; h+<span class="number">1</span>)</span><br><span class="line">    c1, c2 = x % p, x % q</span><br><span class="line">    <span class="built_in">print</span>(p, q, c1, c2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag 转成长整数m</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="comment"># 计算m的二进制位数</span></span><br><span class="line">m_len = m.bit_length()</span><br><span class="line">d, h, st = <span class="number">32</span>, <span class="number">16</span>, <span class="number">32</span></span><br><span class="line">r = m_len % d</span><br><span class="line"><span class="keyword">assert</span> (r &gt; h)</span><br><span class="line"><span class="keyword">while</span> st &lt;= m_len:</span><br><span class="line">    <span class="comment"># 对m进行加密</span></span><br><span class="line">    x = enc(m, st, m_len)</span><br><span class="line">    x &gt;&gt;= (m_len-d)</span><br><span class="line">    <span class="comment"># 输出加密结果</span></span><br><span class="line">    outp(x, h)</span><br><span class="line">    st += d</span><br><span class="line"><span class="comment"># 对 m 进行额外的加密操作，并通过 outp 函数输出最终的加密结果</span></span><br><span class="line">m &gt;&gt;= (m_len-r)</span><br><span class="line">outp(m, h)</span><br></pre></td></tr></table></figure>

<h3 id="掩码"><a href="#掩码" class="headerlink" title="掩码"></a>掩码</h3><blockquote>
<p>在计算机科学中，”掩码”（Mask）是一个用于屏蔽或提取某些位的二进制模式。掩码通常是一个与目标数据进行按位与操作的值，通过这种操作，可以将目标数据的某些位设置为0或从中提取出感兴趣的位。</p>
<p>掩码在计算机编程和计算机系统中有广泛的应用，主要用于以下两个方面：</p>
<ol>
<li>屏蔽位：掩码可以用于屏蔽目标数据的特定位。通过将目标数据与相应的掩码进行按位与操作，可以将不需要的位设置为0，而保留需要的位。这在编程中常用于清除或保留特定标志位，或者过滤掉数据中不需要的部分。</li>
<li>提取位：掩码还可以用于从目标数据中提取出感兴趣的位。通过将目标数据与相应的掩码进行按位与操作，可以将目标数据的其他位设置为0，而保留感兴趣的位。这在计算机系统中常用于从寄存器或数据中提取出特定字段或标志位。</li>
</ol>
<p>掩码通常使用二进制形式表示，并且每个位都对应于目标数据的相应位。在掩码中，1 表示需要保留或提取的位，0 表示需要屏蔽的位。</p>
<p>例如，对于目标数据 <code>11010110</code>，如果我们希望屏蔽掉低三位，我们可以使用掩码 <code>11111000</code>，通过进行按位与操作，结果将是 <code>11010000</code>。同样，如果我们希望提取低四位，我们可以使用掩码 <code>00001111</code>，通过进行按位与操作，结果将是 <code>00000110</code>。</p>
<ul>
<li>总结：与运算取出感兴趣的位，感兴趣为1，不感兴趣为0</li>
</ul>
</blockquote>
<h3 id="关于移位"><a href="#关于移位" class="headerlink" title="关于移位"></a>关于移位</h3><blockquote>
<p>a &gt;&gt; b | (a &amp; ((1 &lt;&lt; b)-1)) &lt;&lt; (c-b)</p>
<p>假设 <code>a</code> 等于 87 （二进制：<code>0b1010111</code>），<code>b</code> 等于 4。</p>
<ol>
<li><code>1 &lt;&lt; b</code> 的结果为 <code>0b10000</code>，也就是十进制数 16。</li>
<li><code>((1 &lt;&lt; b) - 1)</code> 的结果为 <code>0b1111</code>，也就是十进制数 15。</li>
<li><code>a &amp; ((1 &lt;&lt; b) - 1)</code> 就是 <code>0b1010111 &amp; 0b1111</code>，结果为 <code>0b111</code>，也就是十进制数 7。</li>
</ol>
<p>所以，<code>(a &amp; ((1 &lt;&lt; b) - 1))</code> 表达式的结果就是 <code>a</code> 的低 <code>b</code> 位的掩码，它将保留 <code>a</code> 二进制表示中的最后 <code>b</code> 位，并将其他位设置为0。</p>
</blockquote>
<h1 id="RSA系列"><a href="#RSA系列" class="headerlink" title="RSA系列"></a>RSA系列</h1><h2 id="RSA原理"><a href="#RSA原理" class="headerlink" title="RSA原理"></a>RSA原理</h2><p>生成数字</p>
<a class="simple-lightbox" href="/2023/07/20/crypto/image-20230724151309040.png"><img   src="/images/loading.svg" data-src="/2023/07/20/crypto/image-20230724151309040.png"  class="" lazyload></a>

<p>加密与解密</p>
<a class="simple-lightbox" href="/2023/07/20/crypto/image-20230724151346417.png"><img   src="/images/loading.svg" data-src="/2023/07/20/crypto/image-20230724151346417.png"  class="" lazyload></a>

<h2 id="RSA-Py代码实现"><a href="#RSA-Py代码实现" class="headerlink" title="RSA Py代码实现"></a>RSA Py代码实现</h2><p>Python代码的计算过程</p>
<ol>
<li><p>导入子库生成两个大素数，512bit朝</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># getPrime函数，它能够返回一个n位的素数</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br></pre></td></tr></table></figure>
</li>
<li><p>计算欧拉函数和n</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>选取e判断互素性，并且计算逆元</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">e = 65537</span><br><span class="line">assert GCD(e, phi) == 1, &quot;该e不满足互素条件&quot;</span><br><span class="line">d = inverse(e, phi)</span><br></pre></td></tr></table></figure>
</li>
<li><p>加密hello</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这里定义的是byte类型的字符串，每个字符用8位的二进制进行存储，如果直接定义字符串hello，字符串类型需要进行编码字节类型才可以进行加密</span></span><br><span class="line">message = <span class="string">b&#x27;hello&#x27;</span></span><br><span class="line"><span class="comment"># 使用的bytes_to_long函数，将字符串转换为数字</span></span><br><span class="line">m = bytes_to_long(message)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># 消息已经被转换为一个字符串了，可以加密</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">msg = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(msg)</span><br></pre></td></tr></table></figure>
</li>
<li><p>完整代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="keyword">assert</span> GCD(e, phi) == <span class="number">1</span>, <span class="string">&quot;该e不满足互素条件&quot;</span></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;公钥：(<span class="subst">&#123;e&#125;</span>, <span class="subst">&#123;n&#125;</span>)&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;私钥：(<span class="subst">&#123;d&#125;</span>, <span class="subst">&#123;n&#125;</span>)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">message = <span class="string">b&#x27;hello&#x27;</span></span><br><span class="line">m = bytes_to_long(message)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;消息：&#x27;</span>, m)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;密文：&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line">msg = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;明文：&#x27;</span>, msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> msg == m, <span class="string">&quot;解密失败&quot;</span></span><br></pre></td></tr></table></figure></li>
</ol>

        </div>
        <div class="top-div">
          <ol class="top-box"><li class="top-box-item top-box-level-1"><a class="top-box-link" href="#HNCTF"><span class="top-box-text">HNCTF</span></a><ol class="top-box-child"><li class="top-box-item top-box-level-2"><a class="top-box-link" href="#baBAbaseSEse%EF%BC%88base%E5%AE%B6%E6%97%8F%EF%BC%89"><span class="top-box-text">baBAbaseSEse（base家族）</span></a></li><li class="top-box-item top-box-level-2"><a class="top-box-link" href="#babyRsa%EF%BC%88%E5%9F%BA%E6%9C%ACRSA%EF%BC%89"><span class="top-box-text">babyRsa（基本RSA）</span></a></li><li class="top-box-item top-box-level-2"><a class="top-box-link" href="#A-dictator%EF%BC%88%E5%87%AF%E6%92%92%E5%AF%86%E7%A0%81%EF%BC%89"><span class="top-box-text">A dictator（凯撒密码）</span></a></li><li class="top-box-item top-box-level-2"><a class="top-box-link" href="#%E7%88%B1%E5%A6%83%EF%BC%88%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81%EF%BC%89"><span class="top-box-text">爱妃（仿射密码）</span></a></li><li class="top-box-item top-box-level-2"><a class="top-box-link" href="#littleprince-%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B%EF%BC%8C%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86"><span class="top-box-text">littleprince(同余方程，中国剩余定理)</span></a><ol class="top-box-child"><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E6%8E%A9%E7%A0%81"><span class="top-box-text">掩码</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E5%85%B3%E4%BA%8E%E7%A7%BB%E4%BD%8D"><span class="top-box-text">关于移位</span></a></li></ol></li></ol></li><li class="top-box-item top-box-level-1"><a class="top-box-link" href="#RSA%E7%B3%BB%E5%88%97"><span class="top-box-text">RSA系列</span></a><ol class="top-box-child"><li class="top-box-item top-box-level-2"><a class="top-box-link" href="#RSA%E5%8E%9F%E7%90%86"><span class="top-box-text">RSA原理</span></a></li><li class="top-box-item top-box-level-2"><a class="top-box-link" href="#RSA-Py%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="top-box-text">RSA Py代码实现</span></a></li></ol></li></ol>
        </div>
      </div>
    </div>

    
      <div class="next-post">
        <a class="purple-link" href="/2023/07/19/movfuscator%E6%B7%B7%E6%B7%86/">
          <h3 class="post-title">
            下一篇：movfuscator混淆
          </h3>
        </a>
      </div>
    
  </div>










<footer>
<div class="site-footer">
  <div class="social-container">
    
      
        <a aria-label="跳转至github" href="https://github.com/Kidder1" target="_blank">
          <i class="icon icon-github"></i>
        </a>
      
    
      
    
      
    
      
    
      
    
  </div>
  
  
  
  
  
    
      <a href="https://beian.miit.gov.cn" target="_blank">陕ICP备2022004010号-1</a>
  
  
</div>
</footer>


      </div>
    </div>
    
<script id="hexo-configurations"> window.theme_config = {"image":{"lazyload_enable":true,"photo_zoom":"simple-lightbox"}}; window.is_post = true; </script>

<script src="/js/main.js"></script>






  <script src="/js/simple-lightbox.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {new SimpleLightbox('.post-detail .simple-lightbox', {fileExt: false,captionsData:'alt'});});</script></body>
</html>

